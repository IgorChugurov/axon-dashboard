# –û—Ç—á–µ—Ç –æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ SDK –¥–ª—è –ø—É–±–ª–∏—á–Ω–æ–≥–æ API

**–î–∞—Ç–∞:** 2025-01-29  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ  
**–í–µ—Ä—Å–∏—è:** 1.0.0

---

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏

### 1. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ SDK

–°–æ–∑–¥–∞–Ω–∞ –ø–æ–ª–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ SDK:

```
lib/sdk/public-api/
‚îú‚îÄ‚îÄ types.ts                    # ‚úÖ –¢–∏–ø—ã –¥–ª—è SDK
‚îú‚îÄ‚îÄ errors.ts                   # ‚úÖ –ö–ª–∞—Å—Å—ã –æ—à–∏–±–æ–∫
‚îú‚îÄ‚îÄ utils.ts                    # ‚úÖ –£—Ç–∏–ª–∏—Ç—ã (–≤–∞–ª–∏–¥–∞—Ü–∏—è, –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è)
‚îú‚îÄ‚îÄ base/
‚îÇ   ‚îî‚îÄ‚îÄ base-client.ts         # ‚úÖ –ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º
‚îú‚îÄ‚îÄ server/
‚îÇ   ‚îú‚îÄ‚îÄ server-client.ts       # ‚úÖ Server SDK
‚îÇ   ‚îî‚îÄ‚îÄ index.ts
‚îú‚îÄ‚îÄ client/
‚îÇ   ‚îú‚îÄ‚îÄ client-client.ts      # ‚úÖ Client SDK
‚îÇ   ‚îî‚îÄ‚îÄ index.ts
‚îú‚îÄ‚îÄ index.ts                    # ‚úÖ –ì–ª–∞–≤–Ω—ã–π —ç–∫—Å–ø–æ—Ä—Ç
‚îî‚îÄ‚îÄ README.md                   # ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

### 2. –ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å (`BasePublicAPIClient`)

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**

- ‚úÖ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ fields —Å —Ñ–ª–∞–≥–æ–º `enableCache`
- ‚úÖ –ú–µ—Ç–æ–¥ `getFields()` - –∑–∞–≥—Ä—É–∑–∫–∞ fields —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- ‚úÖ –ú–µ—Ç–æ–¥ `getEntityDefinitionConfig()` - –∑–∞–≥—Ä—É–∑–∫–∞ entityDefinition + fields
- ‚úÖ –ê–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–µ –º–µ—Ç–æ–¥—ã –¥–ª—è CRUD –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**

- –ö—ç—à –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `SDKOptions` (enableCache, cacheTTL)
- –õ–µ–Ω–∏–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ fields (—Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω–∞—è —Å—É—â–Ω–æ—Å—Ç—å)
- TTL –∫—ç—à–∞: 5 –º–∏–Ω—É—Ç (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è)

### 3. Server SDK (`ServerPublicAPIClient`)

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**

- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å–µ—Ä–≤–∏—Å—ã (`instance-service`)
- ‚úÖ CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏:
  - `getInstances()` - —Å–ø–∏—Å–æ–∫ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π
  - `getInstance()` - –æ–¥–∏–Ω —ç–∫–∑–µ–º–ø–ª—è—Ä
  - `createInstance()` - —Å–æ–∑–¥–∞–Ω–∏–µ
  - `updateInstance()` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
  - `deleteInstance()` - —É–¥–∞–ª–µ–Ω–∏–µ
- ‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è:
  - `signIn()` - –≤—Ö–æ–¥
  - `signUp()` - —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
  - `signOut()` - –≤—ã—Ö–æ–¥
  - `getCurrentUser()` - —Ç–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**

- –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —á–µ—Ä–µ–∑ `create()`
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `createClient()` –∏–∑ `@/lib/supabase/server`
- –†–∞–±–æ—Ç–∞–µ—Ç —Å cookies –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

### 4. Client SDK (`ClientPublicAPIClient`)

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**

- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å–µ—Ä–≤–∏—Å—ã (`instance-client-service`)
- ‚úÖ CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ (–∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ Server SDK)
- ‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (–∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ Server SDK)

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**

- –°–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —á–µ—Ä–µ–∑ `create()`
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `createClient()` –∏–∑ `@/lib/supabase/client`
- –†–∞–±–æ—Ç–∞–µ—Ç –≤ –±—Ä–∞—É–∑–µ—Ä–µ

### 5. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ (`errors.ts`)

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**

- ‚úÖ `SDKError` - –±–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –æ—à–∏–±–æ–∫
- ‚úÖ `NotFoundError` - 404 –æ—à–∏–±–∫–∞
- ‚úÖ `PermissionDeniedError` - 403 –æ—à–∏–±–∫–∞
- ‚úÖ `ValidationError` - 400 –æ—à–∏–±–∫–∞
- ‚úÖ `AuthenticationError` - 401 –æ—à–∏–±–∫–∞
- ‚úÖ `handleSupabaseError()` - –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ Supabase

### 6. –£—Ç–∏–ª–∏—Ç—ã (`utils.ts`)

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**

- ‚úÖ `validateInstanceData()` - –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –æ—Å–Ω–æ–≤–µ fields
- ‚úÖ `normalizeFieldValue()` - –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∑–Ω–∞—á–µ–Ω–∏–π –ø–æ–ª–µ–π
- ‚úÖ `toCamelCase()` / `toSnakeCase()` - —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è –∏–º–µ–Ω

---

## üìä –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤

SDK –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å–µ—Ä–≤–∏—Å—ã –≤–Ω—É—Ç—Ä–∏:

### Server SDK –∏—Å–ø–æ–ª—å–∑—É–µ—Ç:

- `getInstances()` –∏–∑ `instance-service.ts`
- `getInstanceById()` –∏–∑ `instance-service.ts`
- `createInstance()` –∏–∑ `instance-service.ts`
- `updateInstance()` –∏–∑ `instance-service.ts`
- `deleteInstance()` –∏–∑ `instance-service.ts`

### Client SDK –∏—Å–ø–æ–ª—å–∑—É–µ—Ç:

- `getEntityInstancesFromClient()` –∏–∑ `instance-client-service.ts`
- `createEntityInstanceFromClient()` –∏–∑ `instance-client-service.ts`
- `updateEntityInstanceFromClient()` –∏–∑ `instance-client-service.ts`
- `deleteEntityInstanceFromClient()` –∏–∑ `instance-client-service.ts`

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**

- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–π –∫–æ–¥
- ‚úÖ –ù–µ –¥—É–±–ª–∏—Ä—É–µ—Ç –ª–æ–≥–∏–∫—É
- ‚úÖ –õ–µ–≥–∫–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å

---

## üîß –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

```typescript
// –ö—ç—à fields –ø–æ entityDefinitionId
private fieldsCache: Map<string, {
  fields: FieldConfig[];
  expiresAt: number;
}> = new Map();
```

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

```typescript
// –î–ª—è –ø—É–±–ª–∏—á–Ω–æ–≥–æ API (—Å –∫—ç—à–µ–º)
const sdk = ClientPublicAPIClient.create(projectId, {
  enableCache: true, // –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
});

// –î–ª—è –∞–¥–º–∏–Ω–∫–∏ (–±–µ–∑ –∫—ç—à–∞)
const adminSdk = ClientPublicAPIClient.create(projectId, {
  enableCache: false,
});
```

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

- ‚úÖ –ë—ã—Å—Ç—Ä–µ–µ –∑–∞–≥—Ä—É–∑–∫–∞ (fields –∫—ç—à–∏—Ä—É—é—Ç—Å—è –Ω–∞ 5 –º–∏–Ω—É—Ç)
- ‚úÖ –ú–µ–Ω—å—à–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –ë–î
- ‚úÖ –ì–∏–±–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (–º–æ–∂–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å –¥–ª—è –∞–¥–º–∏–Ω–∫–∏)

---

## üìù –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞

```typescript
// Server Component
const sdk = await ServerPublicAPIClient.create(projectId);
const { data, pagination } = await sdk.getInstances(entityDefinitionId, {
  page: 1,
  limit: 20,
  search: "test",
  includeRelations: ["author"],
});
```

### –ü—Ä–∏–º–µ—Ä 2: –°–æ–∑–¥–∞–Ω–∏–µ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞

```typescript
// Client Component
const sdk = ClientPublicAPIClient.create(projectId);
const instance = await sdk.createInstance(entityDefinitionId, {
  data: {
    name: "Example",
    description: "Description",
  },
  relations: {
    tags: ["tag-id-1", "tag-id-2"],
  },
});
```

### –ü—Ä–∏–º–µ—Ä 3: –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

```typescript
const sdk = ClientPublicAPIClient.create(projectId);
const result = await sdk.signIn("user@example.com", "password123");
// result —Å–æ–¥–µ—Ä–∂–∏—Ç: accessToken, refreshToken, user
```

---

## üîÑ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –∫–æ–¥–æ–º

### –¢–µ–∫—É—â–∏–π –∫–æ–¥ –æ—Å—Ç–∞–µ—Ç—Å—è

- ‚úÖ `instance-service.ts` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ Server SDK
- ‚úÖ `instance-client-service.ts` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ Client SDK
- ‚úÖ `config-service.ts` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- ‚úÖ `relation-service.ts` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å–æ —Å–≤—è–∑—è–º–∏

### –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è

1. **–≠—Ç–∞–ø 1:** SDK –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
2. **–≠—Ç–∞–ø 2:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å SDK –≤ –Ω–æ–≤—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö
3. **–≠—Ç–∞–ø 3:** –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –º–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥

---

## ‚úÖ –ö—Ä–∏—Ç–µ—Ä–∏–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏

- [x] –ë–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ SDK —Å–æ–∑–¥–∞–Ω–∞
- [x] Server SDK —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
- [x] Client SDK —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
- [x] –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [x] –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ SDK
- [x] CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç —á–µ—Ä–µ–∑ SDK
- [x] –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞
- [x] –£—Ç–∏–ª–∏—Ç—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã
- [x] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –Ω–∞–ø–∏—Å–∞–Ω–∞

---

## üì¶ –§–∞–π–ª—ã

### –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:

1. `lib/sdk/public-api/types.ts` - —Ç–∏–ø—ã
2. `lib/sdk/public-api/errors.ts` - –∫–ª–∞—Å—Å—ã –æ—à–∏–±–æ–∫
3. `lib/sdk/public-api/utils.ts` - —É—Ç–∏–ª–∏—Ç—ã
4. `lib/sdk/public-api/base/base-client.ts` - –±–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å
5. `lib/sdk/public-api/server/server-client.ts` - Server SDK
6. `lib/sdk/public-api/server/index.ts` - —ç–∫—Å–ø–æ—Ä—Ç Server SDK
7. `lib/sdk/public-api/client/client-client.ts` - Client SDK
8. `lib/sdk/public-api/client/index.ts` - —ç–∫—Å–ø–æ—Ä—Ç Client SDK
9. `lib/sdk/public-api/index.ts` - –≥–ª–∞–≤–Ω—ã–π —ç–∫—Å–ø–æ—Ä—Ç
10. `lib/sdk/public-api/README.md` - –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

---

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å SDK –≤ —Ä–µ–∞–ª—å–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö
2. **–ú–∏–≥—Ä–∞—Ü–∏—è:** –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –º–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥ –Ω–∞ SDK
3. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:** –£–ª—É—á—à–∏—Ç—å –∑–∞–≥—Ä—É–∑–∫—É relations –≤ Client SDK
4. **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** –î–æ–±–∞–≤–∏—Ç—å –±–æ–ª—å—à–µ –ø—Ä–∏–º–µ—Ä–æ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

---

**SDK –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!** üéâ
