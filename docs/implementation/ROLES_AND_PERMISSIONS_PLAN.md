# –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–∏—Å—Ç–µ–º—ã —Ä–æ–ª–µ–π –∏ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞

## üìã –ê–Ω–∞–ª–∏–∑ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Å–∏—Å—Ç–µ–º–µ:

1. **–†–æ–ª–∏:**

   - `superAdmin` - —Å—É–ø–µ—Ä–∞–¥–º–∏–Ω (–ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø + —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∞–º–∏)
   - `admin` - –∞–¥–º–∏–Ω (–ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø, –Ω–æ –Ω–µ –º–æ–∂–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å –∞–¥–º–∏–Ω–∞–º–∏)
   - `user` - –æ–±—ã—á–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (—Ç–æ–ª—å–∫–æ –ø—É–±–ª–∏—á–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã)

2. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Å—É–ø–µ—Ä–∞–¥–º–∏–Ω–∞:**

   - Email: `igorchugurov@gmail.com`
   - –ü–∞—Ä–æ–ª—å: `1234567!Igor`
   - –†–æ–ª—å: `superAdmin`
   - –°–æ–∑–¥–∞–µ—Ç—Å—è –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –º–∏–≥—Ä–∞—Ü–∏–∏

3. **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∞–º–∏ (—Ç–æ–ª—å–∫–æ –¥–ª—è superAdmin):**

   - –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–ø–∏—Å–∫–∞ –∞–¥–º–∏–Ω–æ–≤
   - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∞ (–µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ—Ç - —Å–æ–∑–¥–∞—Ç—å –µ–≥–æ)
   - –£–¥–∞–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∞ (–∫—Ä–æ–º–µ superAdmin)
   - –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–æ–ª–∏ –∞–¥–º–∏–Ω–∞

4. **–ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞:**

   - `superAdmin` –∏ `admin` ‚Üí –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º —Ç–∞–±–ª–∏—Ü–∞–º –∏ –¥–∞–Ω–Ω—ã–º (–¥–∞—à–±–æ—Ä–¥)
   - `user` ‚Üí —Ç–æ–ª—å–∫–æ –ø—É–±–ª–∏—á–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ + –∫–Ω–æ–ø–∫–∞ logout)

5. **–ó–∞—â–∏—Ç–∞:**
   - `admin` –Ω–µ –º–æ–∂–µ—Ç —É–¥–∞–ª–∏—Ç—å `superAdmin`
   - `admin` –Ω–µ –º–æ–∂–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å –∞–¥–º–∏–Ω–∞–º–∏
   - –û–±—ã—á–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –º–æ–∂–µ—Ç –ø–æ–ø–∞—Å—Ç—å –≤ –¥–∞—à–±–æ—Ä–¥

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:

```
auth.users (Supabase)
    ‚Üì
profiles (–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)
    ‚Üì
admins (—Å–≤—è–∑—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å —Ä–æ–ª—å—é –∞–¥–º–∏–Ω–∞)
    ‚Üì
admin_roles (—Ä–æ–ª–∏: admin, superAdmin)
```

### –¢–∞–±–ª–∏—Ü—ã:

1. **admin_roles** - —Ä–æ–ª–∏ –∞–¥–º–∏–Ω–æ–≤

   - `id` (UUID, PRIMARY KEY)
   - `name` (TEXT, UNIQUE) - 'admin', 'superAdmin'
   - `description` (TEXT)
   - `created_at` (TIMESTAMP)

2. **admins** - —Ç–∞–±–ª–∏—Ü–∞ –∞–¥–º–∏–Ω–æ–≤

   - `id` (UUID, PRIMARY KEY)
   - `user_id` (UUID, REFERENCES auth.users(id))
   - `role_id` (UUID, REFERENCES admin_roles(id))
   - `created_at` (TIMESTAMP)
   - `updated_at` (TIMESTAMP)
   - UNIQUE(user_id) - –æ–¥–∏–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –±—ã—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–Ω–∏–º –∞–¥–º–∏–Ω–æ–º

3. **profiles** (–æ–±–Ω–æ–≤–∏—Ç—å)
   - –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ `is_admin` (BOOLEAN) –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏
   - –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å JOIN —Å admins

### RLS –ø–æ–ª–∏—Ç–∏–∫–∏:

#### –î–ª—è —Ç–∞–±–ª–∏—Ü—ã `admins`:

- **SELECT**: –¢–æ–ª—å–∫–æ superAdmin –º–æ–∂–µ—Ç –≤–∏–¥–µ—Ç—å –≤—Å–µ—Ö –∞–¥–º–∏–Ω–æ–≤
- **INSERT**: –¢–æ–ª—å–∫–æ superAdmin –º–æ–∂–µ—Ç –¥–æ–±–∞–≤–ª—è—Ç—å –∞–¥–º–∏–Ω–æ–≤
- **UPDATE**: –¢–æ–ª—å–∫–æ superAdmin –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω—è—Ç—å —Ä–æ–ª–∏
- **DELETE**: –¢–æ–ª—å–∫–æ superAdmin –º–æ–∂–µ—Ç —É–¥–∞–ª—è—Ç—å –∞–¥–º–∏–Ω–æ–≤ (–∫—Ä–æ–º–µ superAdmin)

#### –î–ª—è –¥—Ä—É–≥–∏—Ö —Ç–∞–±–ª–∏—Ü:

- **superAdmin –∏ admin**: –ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø (–æ–±—Ö–æ–¥ RLS —á–µ—Ä–µ–∑ Service Role –∏–ª–∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏)
- **user**: –¢–æ–ª—å–∫–æ —Å–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ RLS –ø–æ–ª–∏—Ç–∏–∫–∏)

---

## üîÑ –§–ª–æ—É —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã

### 1. –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—Ö–æ–¥–∏—Ç
    ‚Üì
Middleware –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
    ‚Üì
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    ‚îú‚îÄ superAdmin/admin ‚Üí –¥–æ—Å—Ç—É–ø –∫ –¥–∞—à–±–æ—Ä–¥—É
    ‚îî‚îÄ user ‚Üí —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ –ø—É–±–ª–∏—á–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
```

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞:

```typescript
// –í middleware –∏–ª–∏ Server Component
const userRole = await getUserRole(userId);

if (userRole === "user") {
  // –†–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ –ø—É–±–ª–∏—á–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
  redirect("/welcome");
}

if (userRole === "admin" || userRole === "superAdmin") {
  // –î–æ—Å—Ç—É–ø –∫ –¥–∞—à–±–æ—Ä–¥—É
  // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–ª–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
}
```

### 3. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∞–º–∏ (—Ç–æ–ª—å–∫–æ superAdmin):

```
superAdmin –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—É —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∞–¥–º–∏–Ω–∞–º–∏
    ‚Üì
API –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–æ–ª—å (—Ç–æ–ª—å–∫–æ superAdmin)
    ‚Üì
superAdmin –º–æ–∂–µ—Ç:
    - –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–ø–∏—Å–æ–∫ –∞–¥–º–∏–Ω–æ–≤
    - –î–æ–±–∞–≤–∏—Ç—å –∞–¥–º–∏–Ω–∞ (—Å–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
    - –ò–∑–º–µ–Ω–∏—Ç—å —Ä–æ–ª—å –∞–¥–º–∏–Ω–∞
    - –£–¥–∞–ª–∏—Ç—å –∞–¥–º–∏–Ω–∞ (–∫—Ä–æ–º–µ superAdmin)
```

---

## üìù –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –≠—Ç–∞–ø 1: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

1. **–°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É `admin_roles`**

   - –î–æ–±–∞–≤–∏—Ç—å —Ä–æ–ª–∏: 'admin', 'superAdmin'

2. **–°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É `admins`**

   - –°–≤—è–∑—å —Å `auth.users` –∏ `admin_roles`
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å RLS –ø–æ–ª–∏—Ç–∏–∫–∏

3. **–°–æ–∑–¥–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è —Å—É–ø–µ—Ä–∞–¥–º–∏–Ω–∞**

   - –°–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ `auth.users`
   - –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å –≤ `profiles`
   - –î–æ–±–∞–≤–∏—Ç—å –≤ `admins` —Å —Ä–æ–ª—å—é `superAdmin`

4. **–û–±–Ω–æ–≤–∏—Ç—å —Ç—Ä–∏–≥–≥–µ—Ä `handle_new_user`**
   - –ù–µ –¥–æ–±–∞–≤–ª—è—Ç—å –≤ `admins` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ (—Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ superAdmin)

### –≠—Ç–∞–ø 2: –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ä–æ–ª—è–º–∏

1. **–°–æ–∑–¥–∞—Ç—å `lib/auth/roles.ts`**

   - `getUserRole(userId)` - –ø–æ–ª—É—á–∏—Ç—å —Ä–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - `isAdmin(userId)` - –ø—Ä–æ–≤–µ—Ä–∫–∞, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –∞–¥–º–∏–Ω–æ–º
   - `isSuperAdmin(userId)` - –ø—Ä–æ–≤–µ—Ä–∫–∞, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —Å—É–ø–µ—Ä–∞–¥–º–∏–Ω–æ–º
   - `canManageAdmins(userId)` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –Ω–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∞–º–∏

2. **–û–±–Ω–æ–≤–∏—Ç—å `lib/supabase/auth.ts`**
   - –î–æ–±–∞–≤–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### –≠—Ç–∞–ø 3: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ Middleware

1. **–û–±–Ω–æ–≤–∏—Ç—å `middleware.ts`**
   - –ü–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Ä–æ–ª—å
   - –ï—Å–ª–∏ `user` ‚Üí —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ `/welcome`
   - –ï—Å–ª–∏ `admin`/`superAdmin` ‚Üí –¥–æ—Å—Ç—É–ø –∫ –¥–∞—à–±–æ—Ä–¥—É

### –≠—Ç–∞–ø 4: –°–æ–∑–¥–∞–Ω–∏–µ –ø—É–±–ª–∏—á–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã

1. **–°–æ–∑–¥–∞—Ç—å `app/welcome/page.tsx`**
   - –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –¥–ª—è –æ–±—ã—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
   - –ö–Ω–æ–ø–∫–∞ logout
   - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–æ–º, —á—Ç–æ –¥–æ—Å—Ç—É–ø –æ–≥—Ä–∞–Ω–∏—á–µ–Ω

### –≠—Ç–∞–ø 5: API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∞–¥–º–∏–Ω–∞–º–∏

1. **–°–æ–∑–¥–∞—Ç—å `app/api/admin/admins/route.ts`**

   - `GET` - —Å–ø–∏—Å–æ–∫ –∞–¥–º–∏–Ω–æ–≤ (—Ç–æ–ª—å–∫–æ superAdmin)
   - `POST` - –¥–æ–±–∞–≤–∏—Ç—å –∞–¥–º–∏–Ω–∞ (—Ç–æ–ª—å–∫–æ superAdmin)
   - `PATCH` - –∏–∑–º–µ–Ω–∏—Ç—å —Ä–æ–ª—å (—Ç–æ–ª—å–∫–æ superAdmin)
   - `DELETE` - —É–¥–∞–ª–∏—Ç—å –∞–¥–º–∏–Ω–∞ (—Ç–æ–ª—å–∫–æ superAdmin, –∫—Ä–æ–º–µ superAdmin)

2. **–°–æ–∑–¥–∞—Ç—å `app/api/admin/users/route.ts`**
   - `POST` - —Å–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—Ç–æ–ª—å–∫–æ superAdmin)
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç Service Role Key

### –≠—Ç–∞–ø 6: UI –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∞–¥–º–∏–Ω–∞–º–∏

1. **–°–æ–∑–¥–∞—Ç—å `app/admin/admins/page.tsx`**
   - –°–ø–∏—Å–æ–∫ –∞–¥–º–∏–Ω–æ–≤
   - –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∞–¥–º–∏–Ω–∞
   - –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —É–¥–∞–ª–µ–Ω–∏—è/–∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–æ–ª–∏
   - –î–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –¥–ª—è superAdmin

### –≠—Ç–∞–ø 7: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∏–ø–æ–≤

1. **–û–±–Ω–æ–≤–∏—Ç—å `lib/supabase/types.ts`**

   - –î–æ–±–∞–≤–∏—Ç—å —Ç–∏–ø—ã –¥–ª—è `admin_roles` –∏ `admins`

2. **–û–±–Ω–æ–≤–∏—Ç—å `lib/auth/types.ts`**
   - –î–æ–±–∞–≤–∏—Ç—å —Ç–∏–ø—ã –¥–ª—è —Ä–æ–ª–µ–π

---

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ó–∞—â–∏—Ç–∞ –Ω–∞ —É—Ä–æ–≤–Ω–µ –ë–î (RLS):

1. **–¢–∞–±–ª–∏—Ü–∞ `admins`:**

   - –¢–æ–ª—å–∫–æ superAdmin –º–æ–∂–µ—Ç —á–∏—Ç–∞—Ç—å/–∏–∑–º–µ–Ω—è—Ç—å
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é `is_super_admin()` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

2. **–î—Ä—É–≥–∏–µ —Ç–∞–±–ª–∏—Ü—ã:**
   - –î–ª—è superAdmin/admin: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Service Role Key –∏–ª–∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
   - –î–ª—è user: —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ RLS –ø–æ–ª–∏—Ç–∏–∫–∏

### –ó–∞—â–∏—Ç–∞ –Ω–∞ —É—Ä–æ–≤–Ω–µ API:

1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–∏ –≤ –∫–∞–∂–¥–æ–º API route:**

   ```typescript
   const role = await getUserRole(userId);
   if (role !== "superAdmin") {
     return NextResponse.json({ error: "Forbidden" }, { status: 403 });
   }
   ```

2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ middleware:**
   - –†–µ–¥–∏—Ä–µ–∫—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±–µ–∑ –ø—Ä–∞–≤ –Ω–∞ –ø—É–±–ª–∏—á–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É

### –ó–∞—â–∏—Ç–∞ –Ω–∞ —É—Ä–æ–≤–Ω–µ UI:

1. **–£—Å–ª–æ–≤–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥:**
   - –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –∞–¥–º–∏–Ω—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ç–æ–ª—å–∫–æ superAdmin
   - –°–∫—Ä—ã–≤–∞—Ç—å –Ω–∞–≤–∏–≥–∞—Ü–∏—é –∫ –∞–¥–º–∏–Ω—Å–∫–∏–º —Ä–∞–∑–¥–µ–ª–∞–º –¥–ª—è –æ–±—ã—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

---

## üìä –°—Ö–µ–º–∞ —Ä–∞–±–æ—Ç—ã

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –û–±—ã—á–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å

```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è/–≤—Ö–æ–¥–∏—Ç
   ‚Üì
2. Middleware –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–æ–ª—å ‚Üí 'user'
   ‚Üì
3. –†–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ /welcome
   ‚Üì
4. –í–∏–¥–∏—Ç –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ + –∫–Ω–æ–ø–∫—É logout
   ‚Üì
5. –ù–µ –º–æ–∂–µ—Ç –ø–æ–ø–∞—Å—Ç—å –≤ –¥–∞—à–±–æ—Ä–¥ (middleware –±–ª–æ–∫–∏—Ä—É–µ—Ç)
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ê–¥–º–∏–Ω

```
1. –ê–¥–º–∏–Ω –≤—Ö–æ–¥–∏—Ç
   ‚Üì
2. Middleware –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–æ–ª—å ‚Üí 'admin'
   ‚Üì
3. –î–æ—Å—Ç—É–ø –∫ –¥–∞—à–±–æ—Ä–¥—É
   ‚Üì
4. –í–∏–¥–∏—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ, –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å —Ç–∞–±–ª–∏—Ü–∞–º–∏
   ‚Üì
5. –ù–ï –≤–∏–¥–∏—Ç —Ä–∞–∑–¥–µ–ª —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∞–¥–º–∏–Ω–∞–º–∏
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –°—É–ø–µ—Ä–∞–¥–º–∏–Ω

```
1. –°—É–ø–µ—Ä–∞–¥–º–∏–Ω –≤—Ö–æ–¥–∏—Ç
   ‚Üì
2. Middleware –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–æ–ª—å ‚Üí 'superAdmin'
   ‚Üì
3. –î–æ—Å—Ç—É–ø –∫ –¥–∞—à–±–æ—Ä–¥—É
   ‚Üì
4. –í–∏–¥–∏—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ + —Ä–∞–∑–¥–µ–ª —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∞–¥–º–∏–Ω–∞–º–∏
   ‚Üì
5. –ú–æ–∂–µ—Ç –¥–æ–±–∞–≤–ª—è—Ç—å/—É–¥–∞–ª—è—Ç—å/–∏–∑–º–µ–Ω—è—Ç—å –∞–¥–º–∏–Ω–æ–≤
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 4: –°—É–ø–µ—Ä–∞–¥–º–∏–Ω –¥–æ–±–∞–≤–ª—è–µ—Ç –∞–¥–º–∏–Ω–∞

```
1. –°—É–ø–µ—Ä–∞–¥–º–∏–Ω –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç /admin/admins
   ‚Üì
2. –ó–∞–ø–æ–ª–Ω—è–µ—Ç —Ñ–æ—Ä–º—É (email, —Ä–æ–ª—å)
   ‚Üì
3. API –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–æ–ª—å ‚Üí superAdmin ‚úì
   ‚Üì
4. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –µ—Å—Ç—å –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:
   ‚îú‚îÄ –ï—Å—Ç—å ‚Üí –¥–æ–±–∞–≤–ª—è–µ—Ç –≤ admins
   ‚îî‚îÄ –ù–µ—Ç ‚Üí —Å–æ–∑–¥–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ‚Üí –¥–æ–±–∞–≤–ª—è–µ—Ç –≤ admins
   ‚Üì
5. –ù–æ–≤—ã–π –∞–¥–º–∏–Ω –º–æ–∂–µ—Ç –≤–æ–π—Ç–∏ –∏ –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø
```

---

## ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø–æ–¥—Ö–æ–¥–∞

1. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:**

   - RLS –Ω–∞ —É—Ä–æ–≤–Ω–µ –ë–î
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –≤ API
   - Middleware –±–ª–æ–∫–∏—Ä—É–µ—Ç –¥–æ—Å—Ç—É–ø

2. **–ì–∏–±–∫–æ—Å—Ç—å:**

   - –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ —Ä–æ–ª–∏
   - –õ–µ–≥–∫–æ –∏–∑–º–µ–Ω–∏—Ç—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞

3. **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å:**

   - –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –±–æ–ª—å—à–µ —Ä–æ–ª–µ–π
   - –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –±–æ–ª–µ–µ –¥–µ—Ç–∞–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞

4. **–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ª—É—á—à–∏–º –ø—Ä–∞–∫—Ç–∏–∫–∞–º:**
   - –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Ä–æ–ª–µ–π –∏ –ø—Ä–∞–≤
   - –ó–∞—â–∏—Ç–∞ –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —É—Ä–æ–≤–Ω—è—Ö
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ RLS –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

---

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. –°–æ–∑–¥–∞—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—É—é SQL –º–∏–≥—Ä–∞—Ü–∏—é
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —É—Ç–∏–ª–∏—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ä–æ–ª—è–º–∏
3. –û–±–Ω–æ–≤–∏—Ç—å middleware
4. –°–æ–∑–¥–∞—Ç—å –ø—É–±–ª–∏—á–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
5. –°–æ–∑–¥–∞—Ç—å API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∞–¥–º–∏–Ω–∞–º–∏
6. –°–æ–∑–¥–∞—Ç—å UI –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∞–¥–º–∏–Ω–∞–º–∏
7. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

---

## ‚ùì –í–æ–ø—Ä–æ—Å—ã –¥–ª—è —É—Ç–æ—á–Ω–µ–Ω–∏—è

1. –ù—É–∂–Ω–∞ –ª–∏ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤ (–Ω–µ —Å—É–ø–µ—Ä–∞–¥–º–∏–Ω–æ–≤) —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–æ–º?
2. –ù—É–∂–Ω–∞ –ª–∏ –∏—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π —Ä–æ–ª–µ–π (audit log)?
3. –ù—É–∂–Ω–∞ –ª–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–∞—Ç—å –∞–¥–º–∏–Ω–æ–≤ (–±–µ–∑ —É–¥–∞–ª–µ–Ω–∏—è)?
4. –ö–∞–∫–∏–µ –∏–º–µ–Ω–Ω–æ "–ø—É–±–ª–∏—á–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã" –Ω—É–∂–Ω—ã –¥–ª—è –æ–±—ã—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π?
