# –ü–ª–∞–Ω –º–∏–≥—Ä–∞—Ü–∏–∏ –Ω–∞ nuqs - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è Next.js App Router

**–î–∞—Ç–∞:** 2025-01-28  
**–°—Ç–∞—Ç—É—Å:** –ü–ª–∞–Ω –≥–æ—Ç–æ–≤ –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

---

## üéØ –ü–æ—á–µ–º—É nuqs?

**nuqs** - —ç—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å URL –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –≤ Next.js App Router:

- ‚úÖ **1.5k+ ‚≠ê –Ω–∞ GitHub** - –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ
- ‚úÖ **Type-safe** - –ø–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ TypeScript
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è** —Å URL
- ‚úÖ **–í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π debounce** –¥–ª—è –ø–æ–∏—Å–∫–∞
- ‚úÖ **–†–µ—à–∞–µ—Ç –≤—Å–µ –ø—Ä–æ–±–ª–µ–º—ã** –∏–∑ –∫–æ—Ä–æ–±–∫–∏:
  - –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è URL
  - –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è state ‚Üî URL
  - –ë—Ä–∞—É–∑–µ—Ä–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è
  - –ü–ª–∞–≤–Ω—ã–µ –ø–µ—Ä–µ—Ö–æ–¥—ã

---

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
npm install nuqs
```

---

## üîÑ –ü–ª–∞–Ω –º–∏–≥—Ä–∞—Ü–∏–∏

### –®–∞–≥ 1: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å nuqs

```bash
npm install nuqs
```

### –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å NuqsAdapter (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

–î–ª—è Next.js App Router –æ–±—ã—á–Ω–æ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞, –Ω–æ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ `app/layout.tsx`:

```typescript
import { NuqsAdapter } from "nuqs/adapters/next/app";

export default function RootLayout({ children }) {
  return (
    <html>
      <body>
        <NuqsAdapter>{children}</NuqsAdapter>
      </body>
    </html>
  );
}
```

### –®–∞–≥ 3: –ü–µ—Ä–µ–ø–∏—Å–∞—Ç—å `use-list-params.ts` –∏—Å–ø–æ–ª—å–∑—É—è `useQueryState`

**–¢–µ–∫—É—â–∏–π –∫–æ–¥ (—Å–ª–æ–∂–Ω—ã–π):**

- –õ–æ–∫–∞–ª—å–Ω—ã–π state –¥–ª—è –æ–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å URL —á–µ—Ä–µ–∑ `startTransition`
- –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ `useEffect` –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

**–ù–æ–≤—ã–π –∫–æ–¥ (–ø—Ä–æ—Å—Ç–æ–π —Å nuqs):**

```typescript
"use client";

import { useQueryState } from "nuqs";
import { useCallback, useMemo } from "react";
import type { LoadParams } from "../types/list-types";

interface UseListParamsOptions {
  projectId: string;
  serviceType: string;
  pageSize: number;
}

interface UseListParamsReturn {
  params: LoadParams;
  setParams: (updates: Partial<LoadParams>) => void;
  searchInput: string;
  setSearchInput: (value: string) => void;
  isPending: boolean;
}

export function useListParams({
  projectId,
  serviceType,
  pageSize,
}: UseListParamsOptions): UseListParamsReturn {
  // Page - —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π –∏ –¥–µ—Ñ–æ–ª—Ç–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º
  const [page, setPage] = useQueryState("page", {
    defaultValue: 1,
    parse: (value) => {
      const parsed = parseInt(value, 10);
      return parsed > 0 ? parsed : 1;
    },
    serialize: (value) => value.toString(),
    clearOnDefault: true, // –£–¥–∞–ª—è–µ–º –∏–∑ URL –µ—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ = 1
  });

  // Limit - —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π –∏ –¥–µ—Ñ–æ–ª—Ç–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º
  const [limit, setLimit] = useQueryState("limit", {
    defaultValue: pageSize,
    parse: (value) => {
      const parsed = parseInt(value, 10);
      return parsed > 0 ? parsed : pageSize;
    },
    serialize: (value) => value.toString(),
    clearOnDefault: true, // –£–¥–∞–ª—è–µ–º –∏–∑ URL –µ—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ = pageSize
  });

  // Search - —Å debounce (–≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –≤ nuqs!)
  const [search, setSearch] = useQueryState("search", {
    defaultValue: "",
    debounce: 300, // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π debounce!
    clearOnDefault: true, // –£–¥–∞–ª—è–µ–º –∏–∑ URL –µ—Å–ª–∏ –ø—É—Å—Ç–æ
  });

  // –°—Ç–∞–±–∏–ª–∏–∑–∏—Ä—É–µ–º params –¥–ª—è React Query
  const params: LoadParams = useMemo(
    () => ({
      page: page ?? 1,
      limit: limit ?? pageSize,
      search: search || undefined,
    }),
    [page, limit, search, pageSize]
  );

  // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
  const setParams = useCallback(
    (updates: Partial<LoadParams>) => {
      if (updates.page !== undefined) {
        setPage(updates.page);
      }
      if (updates.limit !== undefined) {
        setLimit(updates.limit);
      }
      if (updates.search !== undefined) {
        setSearch(updates.search || "");
      }
    },
    [setPage, setLimit, setSearch]
  );

  return {
    params,
    setParams,
    searchInput: search || "",
    setSearchInput: setSearch,
    isPending: false, // nuqs –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —ç—Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
  };
}
```

### –®–∞–≥ 4: –£–ø—Ä–æ—Å—Ç–∏—Ç—å `UniversalEntityListDataTable.tsx`

**–£–±—Ä–∞—Ç—å:**

- –õ–æ–≥–∏–∫—É –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è `hasLoadedOnceRef` (–Ω–µ –Ω—É–∂–Ω–∞ —Å nuqs)
- –°–ª–æ–∂–Ω—É—é –ª–æ–≥–∏–∫—É —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

**–û—Å—Ç–∞–≤–∏—Ç—å:**

- React Query –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö
- `placeholderData` –¥–ª—è –ø–ª–∞–≤–Ω—ã—Ö –ø–µ—Ä–µ—Ö–æ–¥–æ–≤
- Overlay loading –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö

### –®–∞–≥ 5: –û–±–Ω–æ–≤–∏—Ç—å React Query –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `placeholderData`

**–¢–µ–∫—É—â–∏–π –∫–æ–¥:**

```typescript
placeholderData: (previousData) => previousData,
```

**–≠—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ!** –û—Å—Ç–∞–≤–ª—è–µ–º –∫–∞–∫ –µ—Å—Ç—å.

---

## ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏

### –î–æ (—Ç–µ–∫—É—â–∏–π –∫–æ–¥):

- ‚ùå 210 —Å—Ç—Ä–æ–∫ —Å–ª–æ–∂–Ω–æ–π –ª–æ–≥–∏–∫–∏
- ‚ùå –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ `useEffect` –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- ‚ùå –ü—Ä–æ–±–ª–µ–º—ã —Å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å—é URL
- ‚ùå –†—É—á–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ debounce
- ‚ùå –°–ª–æ–∂–Ω–∞—è –ª–æ–≥–∏–∫–∞ –æ–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

### –ü–æ—Å–ª–µ (—Å nuqs):

- ‚úÖ ~80 —Å—Ç—Ä–æ–∫ –ø—Ä–æ—Å—Ç–æ–≥–æ –∫–æ–¥–∞
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è URL ‚Üî state
- ‚úÖ –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π debounce –¥–ª—è –ø–æ–∏—Å–∫–∞
- ‚úÖ –†–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç–∏ –∏–∑ –∫–æ—Ä–æ–±–∫–∏
- ‚úÖ Type-safe –∏–∑ –∫–æ—Ä–æ–±–∫–∏
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç —Å –±—Ä–∞—É–∑–µ—Ä–Ω–æ–π –Ω–∞–≤–∏–≥–∞—Ü–∏–µ–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

---

## üîç –ß—Ç–æ —Ä–µ—à–∞–µ—Ç nuqs

### 1. –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è URL

**–ü—Ä–æ–±–ª–µ–º–∞:** `router.replace` –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π, `searchParams` –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –≤ —Å–ª–µ–¥—É—é—â–µ–º —Ä–µ–Ω–¥–µ—Ä–µ

**–†–µ—à–µ–Ω–∏–µ nuqs:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å, —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç state –∏ URL

### 2. –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è state ‚Üî URL

**–ü—Ä–æ–±–ª–µ–º–∞:** –ù—É–∂–Ω–æ –≤—Ä—É—á–Ω—É—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–π state —Å URL

**–†–µ—à–µ–Ω–∏–µ nuqs:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –≤ –æ–±–µ —Å—Ç–æ—Ä–æ–Ω—ã

### 3. Debounce –¥–ª—è –ø–æ–∏—Å–∫–∞

**–ü—Ä–æ–±–ª–µ–º–∞:** –ù—É–∂–Ω–æ –≤—Ä—É—á–Ω—É—é —Ä–µ–∞–ª–∏–∑–æ–≤—ã–≤–∞—Ç—å debounce

**–†–µ—à–µ–Ω–∏–µ nuqs:** –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π debounce —á–µ—Ä–µ–∑ –æ–ø—Ü–∏—é `debounce: 300`

### 4. –ë—Ä–∞—É–∑–µ—Ä–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è

**–ü—Ä–æ–±–ª–µ–º–∞:** –ù—É–∂–Ω–æ –≤—Ä—É—á–Ω—É—é –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –∫–Ω–æ–ø–∫–∏ –ù–∞–∑–∞–¥/–í–ø–µ—Ä–µ–¥

**–†–µ—à–µ–Ω–∏–µ nuqs:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è —Å –∏—Å—Ç–æ—Ä–∏–µ–π –±—Ä–∞—É–∑–µ—Ä–∞

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **GitHub:** https://github.com/47ng/nuqs
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** https://nuqs.47ng.com
- **–ü—Ä–∏–º–µ—Ä—ã:** https://nuqs.47ng.com/docs/examples

---

## üéØ –ò—Ç–æ–≥

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `nuqs`** - —ç—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ, –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è Next.js App Router, –∫–æ—Ç–æ—Ä–æ–µ:

- ‚úÖ –†–µ—à–∞–µ—Ç –≤—Å–µ –Ω–∞—à–∏ –ø—Ä–æ–±–ª–µ–º—ã –∏–∑ –∫–æ—Ä–æ–±–∫–∏
- ‚úÖ –£–ø—Ä–æ—â–∞–µ—Ç –∫–æ–¥ –≤ 2-3 —Ä–∞–∑–∞
- ‚úÖ Type-safe –∏ —Ö–æ—Ä–æ—à–æ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ
- ‚úÖ –û—á–µ–Ω—å –ø–æ–ø—É–ª—è—Ä–Ω–æ –≤ —Å–æ–æ–±—â–µ—Å—Ç–≤–µ (1.5k+ ‚≠ê)

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞:** –ü—Ä–æ–¥–æ–ª–∂–∞—Ç—å —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —Å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ —Ä–µ—à–µ–Ω–∏—è–º–∏ (–Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
