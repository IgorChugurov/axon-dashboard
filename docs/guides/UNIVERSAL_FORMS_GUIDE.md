# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã—Ö —Ñ–æ—Ä–º

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-01-30  
**–í–µ—Ä—Å–∏—è:** 1.0

---

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–û–±–∑–æ—Ä](#–æ–±–∑–æ—Ä)
2. [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)
3. [–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç](#–±—ã—Å—Ç—Ä—ã–π-—Å—Ç–∞—Ä—Ç)
4. [–¢–∏–ø—ã —Ñ–æ—Ä–º](#—Ç–∏–ø—ã-—Ñ–æ—Ä–º)
5. [–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è](#–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)
6. [–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è](#–ø—Ä–∏–º–µ—Ä—ã-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)
7. [–û–±—Ä–∞–±–æ—Ç–∫–∞ relations](#–æ–±—Ä–∞–±–æ—Ç–∫–∞-relations)
8. [–õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏](#–ª—É—á—à–∏–µ-–ø—Ä–∞–∫—Ç–∏–∫–∏)

---

## –û–±–∑–æ—Ä

–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ñ–æ—Ä–º –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å —Ñ–æ—Ä–º—ã —Å–æ–∑–¥–∞–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ JSON –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏–ª–∏ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –ë–î.

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

- **`UniversalEntityFormNew`** - –±–∞–∑–æ–≤—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Ñ–æ—Ä–º—ã
- **`FormWithSectionsShadcn`** - –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ –ø–æ–ª–µ–π
- **–°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ–±—ë—Ä—Ç–∫–∏** - –≥–æ—Ç–æ–≤—ã–µ –æ–±—ë—Ä—Ç–∫–∏ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Ç–∏–ø–æ–≤ —Å—É—â–Ω–æ—Å—Ç–µ–π

### –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

‚úÖ –ê–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–æ–ª–µ–π –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞  
‚úÖ –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ–ª–µ–π –≤ —Å–µ–∫—Ü–∏–∏  
‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è  
‚úÖ React Query –º—É—Ç–∞—Ü–∏–∏  
‚úÖ –û–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è  
‚úÖ Toast —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è  
‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ relations  
‚úÖ JSONB –¥–∞–Ω–Ω—ã–µ  

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ         –°—Ç—Ä–∞–Ω–∏—Ü–∞ (Server Component)      ‚îÇ
‚îÇ  app/projects/[projectId]/new/page.tsx    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
               ‚îÇ
               ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ    –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –æ–±—ë—Ä—Ç–∫–∞            ‚îÇ
‚îÇ  ProjectFormNew                          ‚îÇ
‚îÇ  - –ó–∞–≥—Ä—É–∂–∞–µ—Ç –∫–æ–Ω—Ñ–∏–≥ –∏–∑ JSON               ‚îÇ
‚îÇ  - –°–æ–∑–¥–∞—ë—Ç —Ñ—É–Ω–∫—Ü–∏–∏ onCreate/onUpdate      ‚îÇ
‚îÇ  - –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç redirectUrl –∏ queryKey    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
               ‚îÇ
               ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ    UniversalEntityFormNew                ‚îÇ
‚îÇ  - –£–ø—Ä–∞–≤–ª—è–µ—Ç React Query –º—É—Ç–∞—Ü–∏—è–º–∏       ‚îÇ
‚îÇ  - –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç submit                    ‚îÇ
‚îÇ  - –£–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞–≤–∏–≥–∞—Ü–∏–µ–π                   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
               ‚îÇ
               ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ    FormWithSectionsShadcn                ‚îÇ
‚îÇ  - –ì—Ä—É–ø–ø–∏—Ä—É–µ—Ç –ø–æ–ª—è –≤ —Å–µ–∫—Ü–∏–∏              ‚îÇ
‚îÇ  - –†–µ–Ω–¥–µ—Ä–∏—Ç –ø–æ–ª—è –ø–æ —Ç–∏–ø—É                 ‚îÇ
‚îÇ  - –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏—é                ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –°–æ–∑–¥–∞–Ω–∏–µ —Ñ–æ—Ä–º—ã –∏–∑ JSON –∫–æ–Ω—Ñ–∏–≥–∞

**–®–∞–≥ 1:** –°–æ–∑–¥–∞–π—Ç–µ JSON –∫–æ–Ω—Ñ–∏–≥ (`config/my-entity.json`):

```json
{
  "form": {
    "createTitle": "Create New Entity",
    "editTitle": "Edit Entity",
    "sections": [
      {
        "title": "Basic Information",
        "index": 0
      }
    ]
  },
  "messages": {
    "afterCreate": "Entity created successfully",
    "afterUpdate": "Entity updated successfully",
    "afterDelete": "Entity deleted successfully",
    "errorCreate": "Failed to create entity",
    "errorUpdate": "Failed to update entity"
  },
  "fields": [
    {
      "name": "name",
      "label": "Name",
      "type": "text",
      "dbType": "varchar",
      "required": true,
      "sectionIndex": 0,
      "displayIndex": 0
    },
    {
      "name": "description",
      "label": "Description",
      "type": "textarea",
      "dbType": "varchar",
      "sectionIndex": 0,
      "displayIndex": 1
    }
  ]
}
```

**–®–∞–≥ 2:** –°–æ–∑–¥–∞–π—Ç–µ –æ–±—ë—Ä—Ç–∫—É:

```typescript
// components/my-entities/MyEntityFormNew.tsx
"use client";

import { useMemo } from "react";
import { UniversalEntityFormNew } from "@/components/UniversalEntityFormNew";
import { createEntityDefinitionAndFieldsFromConfig } from "@/lib/universal-entity/config-utils";
import {
  createMyEntityFromClient,
  updateMyEntityFromClient,
  deleteMyEntityFromClient,
} from "@/lib/my-entities/client-service";
import myEntityConfig from "@/config/my-entity.json";
import type { EntityConfigFile } from "@/lib/universal-entity/config-file-types";

interface MyEntityFormNewProps {
  projectId: string;
  mode: "create" | "edit";
  entityId?: string;
  initialData?: {
    name: string;
    description?: string;
  };
}

export function MyEntityFormNew({
  projectId,
  mode,
  entityId,
  initialData,
}: MyEntityFormNewProps) {
  // –°–æ–∑–¥–∞—ë–º entityDefinition –∏ fields –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞
  const { entityDefinition, fields } = useMemo(
    () => createEntityDefinitionAndFieldsFromConfig(projectId, myEntityConfig as unknown as EntityConfigFile),
    [projectId]
  );

  // –ò–∑–≤–ª–µ–∫–∞–µ–º uiConfig
  const uiConfig = useMemo(() => {
    const { fields: _fields, ...uiConfig } = myEntityConfig;
    return uiConfig;
  }, []);

  // –§—É–Ω–∫—Ü–∏–∏ –º—É—Ç–∞—Ü–∏–∏
  const handleCreate = async (data: Record<string, any>) => {
    return createMyEntityFromClient(projectId, data);
  };

  const handleUpdate = async (id: string, data: Record<string, any>) => {
    return updateMyEntityFromClient(id, data);
  };

  const handleDelete = async (id: string) => {
    return deleteMyEntityFromClient(projectId, id);
  };

  return (
    <UniversalEntityFormNew
      entityDefinition={entityDefinition}
      fields={fields}
      uiConfig={uiConfig}
      mode={mode}
      initialData={initialData}
      instanceId={entityId}
      projectId={projectId}
      onCreate={handleCreate}
      onUpdate={handleUpdate}
      onDelete={handleDelete}
      redirectUrl={`/projects/${projectId}/my-entities`}
      queryKey={["list", projectId, "my-entity"]}
    />
  );
}
```

**–®–∞–≥ 3:** –°–æ–∑–¥–∞–π—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã:

```typescript
// app/projects/[projectId]/my-entities/new/page.tsx
import { MyEntityFormNew } from "@/components/my-entities/MyEntityFormNew";

export default function NewMyEntityPage({ params }) {
  const { projectId } = await params;
  
  return (
    <MyEntityFormNew projectId={projectId} mode="create" />
  );
}
```

```typescript
// app/projects/[projectId]/my-entities/[entityId]/page.tsx
import { MyEntityFormNew } from "@/components/my-entities/MyEntityFormNew";
import { getMyEntityById } from "@/lib/my-entities/service";

export default async function EditMyEntityPage({ params }) {
  const { projectId, entityId } = await params;
  
  const entity = await getMyEntityById(entityId);
  
  return (
    <MyEntityFormNew
      projectId={projectId}
      mode="edit"
      entityId={entityId}
      initialData={entity}
    />
  );
}
```

### 2. –°–æ–∑–¥–∞–Ω–∏–µ —Ñ–æ—Ä–º—ã –∏–∑ –¥–∞–Ω–Ω—ã—Ö –ë–î

–î–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π (Entity Instances):

```typescript
// app/projects/[projectId]/[entityDefId]/new/page.tsx
import { EntityInstanceFormNew } from "@/components/entity-instances/EntityInstanceFormNew";
import { getEntityDefinitionWithUIConfig } from "@/lib/universal-entity/config-service";

export default async function EntityNewPage({ params }) {
  const { projectId, entityDefId } = await params;
  
  const config = await getEntityDefinitionWithUIConfig(entityDefId);
  
  return (
    <EntityInstanceFormNew
      projectId={projectId}
      entityDefinition={config.entityDefinition}
      fields={config.fields}
      uiConfig={config.uiConfig}
      mode="create"
    />
  );
}
```

---

## –¢–∏–ø—ã —Ñ–æ—Ä–º

### 1. ProjectFormNew

–î–ª—è –ø—Ä–æ–µ–∫—Ç–æ–≤ (–∫–æ—Ä–Ω–µ–≤—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏):

```typescript
<ProjectFormNew
  mode="create"
  // –∏–ª–∏
  mode="edit"
  projectId={projectId}
  initialData={project}
/>
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `projectId: "global"`
- –û—á–∏—â–∞–µ—Ç –∫—É–∫—É –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏

### 2. EntityDefinitionFormNew

–î–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π —Å—É—â–Ω–æ—Å—Ç–µ–π:

```typescript
<EntityDefinitionFormNew
  projectId={projectId}
  mode="create"
  // –∏–ª–∏
  mode="edit"
  entityDefinitionId={entityDefId}
  initialData={entityDefinition}
/>
```

### 3. EntityInstanceFormNew

–î–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤:

```typescript
<EntityInstanceFormNew
  projectId={projectId}
  entityDefinition={entityDefinition}
  fields={fields}
  uiConfig={uiConfig}
  mode="create"
  // –∏–ª–∏
  mode="edit"
  instanceId={instanceId}
  initialData={formData}
/>
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞–∑–¥–µ–ª—è–µ—Ç data –∏ relations
- –ó–∞–≥—Ä—É–∂–∞–µ—Ç relations –∫–∞–∫ ID –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- –ó–∞–≥—Ä—É–∂–∞–µ—Ç relations –∫–∞–∫ –æ–±—ä–µ–∫—Ç—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è

### 4. EnvironmentFormNew

–î–ª—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è:

```typescript
<EnvironmentFormNew
  projectId={projectId}
  mode="create"
  // –∏–ª–∏
  mode="edit"
  environmentId={environmentId}
  initialData={environment}
/>
```

### 5. FieldFormNew

–î–ª—è –ø–æ–ª–µ–π (–∫–∞—Å—Ç–æ–º–Ω–∞—è —Ñ–æ—Ä–º–∞):

```typescript
<FieldFormNew
  projectId={projectId}
  entityDefinitionId={entityDefId}
  mode="create"
  // –∏–ª–∏
  mode="edit"
  fieldId={fieldId}
  initialData={field}
  availableEntities={entities}
  availableFields={fields}
/>
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –≠—Ç–æ –∫–∞—Å—Ç–æ–º–Ω–∞—è —Ñ–æ—Ä–º–∞ –∏–∑-–∑–∞ —Å–ª–æ–∂–Ω–æ–π –ª–æ–≥–∏–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø–æ–ª–µ–π.

---

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ JSON –∫–æ–Ω—Ñ–∏–≥–∞

```typescript
interface EntityConfigFile {
  form: {
    createTitle: string;
    editTitle: string;
    sections: SectionConfig[];
  };
  messages: {
    afterCreate?: string;
    afterUpdate?: string;
    afterDelete?: string;
    errorCreate?: string;
    errorUpdate?: string;
  };
  fields: FieldFromConfig[];
}
```

### –¢–∏–ø—ã –ø–æ–ª–µ–π

```typescript
type FieldType = 
  | "text"              // –¢–µ–∫—Å—Ç–æ–≤–æ–µ –ø–æ–ª–µ
  | "textarea"          // –ú–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã–π —Ç–µ–∫—Å—Ç
  | "number"            // –ß–∏—Å–ª–æ
  | "boolean"            // –ß–µ–∫–±–æ–∫—Å
  | "date"              // –î–∞—Ç–∞
  | "select"            // –í—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫ (one-to-one, many-to-one)
  | "multipleSelect";   // –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –≤—ã–±–æ—Ä (one-to-many, many-to-many)
```

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–æ–ª–µ–π

```json
{
  "name": "name",
  "label": "Name",
  "type": "text",
  "dbType": "varchar",
  "required": true,
  "placeholder": "Enter name",
  "description": "The name of the entity",
  "sectionIndex": 0,
  "displayIndex": 0,
  "forCreatePage": true,
  "forEditPage": true,
  "forEditPageDisabled": false
}
```

### Relations

–î–ª—è –ø–æ–ª–µ–π-—Å–≤—è–∑–µ–π:

```json
{
  "name": "category",
  "label": "Category",
  "type": "select",
  "dbType": "manyToOne",
  "relatedEntityDefinitionId": "category-entity-id",
  "isOptionTitleField": true
}
```

---

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –ü—Ä–æ—Å—Ç–∞—è —Ñ–æ—Ä–º–∞

```json
{
  "form": {
    "createTitle": "Create Product",
    "editTitle": "Edit Product",
    "sections": [
      { "title": "Product Information", "index": 0 }
    ]
  },
  "fields": [
    {
      "name": "name",
      "label": "Product Name",
      "type": "text",
      "dbType": "varchar",
      "required": true,
      "sectionIndex": 0,
      "displayIndex": 0
    },
    {
      "name": "price",
      "label": "Price",
      "type": "number",
      "dbType": "float",
      "required": true,
      "sectionIndex": 0,
      "displayIndex": 1
    }
  ]
}
```

### –ü—Ä–∏–º–µ—Ä 2: –° relations

```json
{
  "fields": [
    {
      "name": "category",
      "label": "Category",
      "type": "select",
      "dbType": "manyToOne",
      "relatedEntityDefinitionId": "category-id",
      "isOptionTitleField": true,
      "sectionIndex": 0,
      "displayIndex": 0
    },
    {
      "name": "tags",
      "label": "Tags",
      "type": "multipleSelect",
      "dbType": "manyToMany",
      "relatedEntityDefinitionId": "tag-id",
      "isOptionTitleField": true,
      "sectionIndex": 0,
      "displayIndex": 1
    }
  ]
}
```

---

## –û–±—Ä–∞–±–æ—Ç–∫–∞ relations

### Entity Instances

–î–ª—è Entity Instances relations –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:

```typescript
// EntityInstanceFormNew –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞–∑–¥–µ–ª—è–µ—Ç:
const { data, relations } = separateDataAndRelations(formData);

// data - –æ–±—ã—á–Ω—ã–µ –ø–æ–ª—è (–∏–¥—É—Ç –≤ JSONB)
// relations - —Å–≤—è–∑–∏ (–∏–¥—É—Ç –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã)
```

### –ö–∞—Å—Ç–æ–º–Ω—ã–µ —Ñ–æ—Ä–º—ã

–î–ª—è –∫–∞—Å—Ç–æ–º–Ω—ã—Ö —Ñ–æ—Ä–º –Ω—É–∂–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å relations –≤—Ä—É—á–Ω—É—é:

```typescript
const handleCreate = async (formData: Record<string, any>) => {
  const relations: Record<string, string[]> = {};
  const data: Record<string, any> = {};

  for (const [key, value] of Object.entries(formData)) {
    if (relationFieldNames.includes(key)) {
      relations[key] = Array.isArray(value) ? value : value ? [value] : [];
    } else {
      data[key] = value;
    }
  }

  return createMyEntityFromClient(projectId, data, relations);
};
```

---

## –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

### 1. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ–±—ë—Ä—Ç–∫–∏

‚úÖ **–•–æ—Ä–æ—à–æ:**
```typescript
<ProjectFormNew mode="create" />
```

‚ùå **–ü–ª–æ—Ö–æ:**
```typescript
<UniversalEntityFormNew
  entityDefinition={...}
  fields={...}
  uiConfig={...}
  mode="create"
  onCreate={...}
  onUpdate={...}
  onDelete={...}
  redirectUrl={...}
  queryKey={...}
/>
```

### 2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ query keys

```typescript
// –î–ª—è –ø—Ä–æ–µ–∫—Ç–æ–≤ (–≥–ª–æ–±–∞–ª—å–Ω—ã–µ)
queryKey: ["list", "global", "project"]

// –î–ª—è —Å—É—â–Ω–æ—Å—Ç–µ–π –ø—Ä–æ–µ–∫—Ç–∞
queryKey: ["list", projectId, "entity-instance"]

// –î–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ç–∏–ø–∞
queryKey: ["list", projectId, "environment"]
```

### 3. –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–π—Ç–µ redirectUrl –ø—Ä–∞–≤–∏–ª—å–Ω–æ

```typescript
// –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è - –Ω–∞ —Å–ø–∏—Å–æ–∫
redirectUrl: `/projects/${projectId}/entities`

// –ü–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è - router.back() (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
// –ü–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è - –Ω–∞ —Å–ø–∏—Å–æ–∫
redirectUrl: `/projects/${projectId}/entities`
```

### 4. –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–π—Ç–µ initialData –ø—Ä–∞–≤–∏–ª—å–Ω–æ

–î–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–≥—Ä—É–∂–∞–π—Ç–µ –¥–∞–Ω–Ω—ã–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:

```typescript
export default async function EditPage({ params }) {
  const entity = await getEntityById(id);
  
  // –ü—Ä–µ–æ–±—Ä–∞–∑—É–π—Ç–µ –≤ —Ñ–æ—Ä–º–∞—Ç —Ñ–æ—Ä–º—ã
  const initialData = {
    name: entity.name,
    description: entity.description,
    // relations –∫–∞–∫ ID –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
    category: entity.categoryId,
    tags: entity.tags.map(t => t.id),
  };
  
  return <MyEntityFormNew mode="edit" initialData={initialData} />;
}
```

### 5. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ transformData –¥–ª—è –∫–∞—Å—Ç–æ–º–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏

```typescript
<UniversalEntityFormNew
  // ...
  transformData={(formData) => {
    // –ö–∞—Å—Ç–æ–º–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π
    return {
      ...formData,
      processedAt: new Date().toISOString(),
    };
  }}
/>
```

### 6. –ì—Ä—É–ø–ø–∏—Ä—É–π—Ç–µ –ø–æ–ª—è –≤ —Å–µ–∫—Ü–∏–∏

```json
{
  "form": {
    "sections": [
      { "title": "Basic Information", "index": 0 },
      { "title": "Additional Details", "index": 1 }
    ]
  },
  "fields": [
    {
      "name": "name",
      "sectionIndex": 0,
      "displayIndex": 0
    },
    {
      "name": "description",
      "sectionIndex": 1,
      "displayIndex": 0
    }
  ]
}
```

---

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ñ–æ—Ä–º](../implementation/UI_CONFIG_SYSTEM_REPORT.md)
- [–¢–∞–±–ª–∏—Ü–∞ —Ä–æ—É—Ç–æ–≤](../reports/ROUTES_ANALYSIS.md)
- [–ü—Ä–∏–º–µ—Ä—ã –∫–æ–Ω—Ñ–∏–≥–æ–≤](../../config/)
- [–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ñ–æ—Ä–º](../implementation/FORM_WITH_SECTIONS_CONNECTED.md)

