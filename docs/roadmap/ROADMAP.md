# üó∫Ô∏è –î–æ—Ä–æ–∂–Ω–∞—è –∫–∞—Ä—Ç–∞ —Ä–∞–∑–≤–∏—Ç–∏—è –ø—Ä–æ–µ–∫—Ç–∞

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-01-XX  
**–í–µ—Ä—Å–∏—è:** 1.0  
**–°—Ç–∞—Ç—É—Å:** üü° –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ

---

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ](#—Ç–µ–∫—É—â–µ–µ-—Å–æ—Å—Ç–æ—è–Ω–∏–µ)
2. [–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –∏ —Ñ–∞–∑—ã](#–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã-–∏-—Ñ–∞–∑—ã)
3. [–î–µ—Ç–∞–ª—å–Ω—ã–µ –ø–ª–∞–Ω—ã](#–¥–µ—Ç–∞–ª—å–Ω—ã–µ-–ø–ª–∞–Ω—ã)
   - [–§–∞–∑–∞ 1: –§–∞–π–ª—ã –∏ Storage](#—Ñ–∞–∑–∞-1-—Ñ–∞–π–ª—ã-–∏-storage)
   - [–§–∞–∑–∞ 2: Content Types Builder](#—Ñ–∞–∑–∞-2-content-types-builder)
   - [–§–∞–∑–∞ 3: –ü—É–±–ª–∏—á–Ω—ã–π API](#—Ñ–∞–∑–∞-3-–ø—É–±–ª–∏—á–Ω—ã–π-api)
   - [–§–∞–∑–∞ 4: API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](#—Ñ–∞–∑–∞-4-api-–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è)
   - [–§–∞–∑–∞ 5: Webhooks](#—Ñ–∞–∑–∞-5-webhooks)
   - [–§–∞–∑–∞ 6: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–≥–æ –∫–æ–¥–∞](#—Ñ–∞–∑–∞-6-–≥–µ–Ω–µ—Ä–∞—Ü–∏—è-–∫–ª–∏–µ–Ω—Ç—Å–∫–æ–≥–æ-–∫–æ–¥–∞)

---

## üìä –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

### ‚úÖ –ß—Ç–æ —É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

- ‚úÖ –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Å—É—â–Ω–æ—Å—Ç–µ–π (`lib/universal-entity/`)
- ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤ –ë–î (`entity_definition`, `field`)
- ‚úÖ –ê–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ñ–æ—Ä–º (`lib/form-generation/`)
- ‚úÖ –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–µ —Å–ø–∏—Å–∫–∏ (`components/universal-entity-list/`)
- ‚úÖ RLS –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (–ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –Ω–∞ —É—Ä–æ–≤–Ω–µ –ë–î)
- ‚úÖ –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ API routes –¥–ª—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ —Ä–æ–ª–µ–π (admin, superAdmin, user)

### ‚ùå –ß—Ç–æ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç

- ‚ùå –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ–∞–π–ª–æ–≤ (file upload)
- ‚ùå –í–∏–∑—É–∞–ª—å–Ω—ã–π Content Types Builder
- ‚ùå –ü—É–±–ª–∏—á–Ω—ã–π API –¥–ª—è –∫–ª–∏–µ–Ω—Ç—Å–∫–∏—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
- ‚ùå API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (OpenAPI/Swagger)
- ‚ùå Webhooks —Å–∏—Å—Ç–µ–º–∞
- ‚ùå –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–≥–æ –∫–æ–¥–∞

---

## üéØ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –∏ —Ñ–∞–∑—ã

### –§–∞–∑–∞ 1: –§–∞–π–ª—ã –∏ Storage (–ö—Ä–∏—Ç–∏—á–Ω–æ)

**–í—Ä–µ–º—è:** 3-4 –¥–Ω—è  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ –í—ã—Å–æ–∫–∏–π  
**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** –ù–µ—Ç

### –§–∞–∑–∞ 2: Content Types Builder (–ö—Ä–∏—Ç–∏—á–Ω–æ)

**–í—Ä–µ–º—è:** 5-7 –¥–Ω–µ–π  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ –í—ã—Å–æ–∫–∏–π  
**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** –§–∞–∑–∞ 1 (–¥–ª—è —Ñ–∞–π–ª–æ–≤—ã—Ö –ø–æ–ª–µ–π)

### –§–∞–∑–∞ 3: –ü—É–±–ª–∏—á–Ω—ã–π API (–ö—Ä–∏—Ç–∏—á–Ω–æ)

**–í—Ä–µ–º—è:** 4-5 –¥–Ω–µ–π  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ –í—ã—Å–æ–∫–∏–π  
**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** –§–∞–∑–∞ 1, –§–∞–∑–∞ 2

### –§–∞–∑–∞ 4: API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (–í–∞–∂–Ω–æ)

**–í—Ä–µ–º—è:** 2-3 –¥–Ω—è  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° –°—Ä–µ–¥–Ω–∏–π  
**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** –§–∞–∑–∞ 3

### –§–∞–∑–∞ 5: Webhooks (–ü–æ–ª–µ–∑–Ω–æ)

**–í—Ä–µ–º—è:** 2-3 –¥–Ω—è  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü¢ –ù–∏–∑–∫–∏–π  
**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** –§–∞–∑–∞ 3

### –§–∞–∑–∞ 6: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–≥–æ –∫–æ–¥–∞ (–í–∞–∂–Ω–æ)

**–í—Ä–µ–º—è:** 5-7 –¥–Ω–µ–π  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° –°—Ä–µ–¥–Ω–∏–π  
**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** –§–∞–∑–∞ 3, –§–∞–∑–∞ 4

---

## üìù –î–µ—Ç–∞–ª—å–Ω—ã–µ –ø–ª–∞–Ω—ã

---

## –§–∞–∑–∞ 1: –§–∞–π–ª—ã –∏ Storage

### üéØ –¶–µ–ª—å

–î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É –ø–æ–ª–µ–π —Ç–∏–ø–∞ `file` –∏ `files` –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –æ–¥–Ω–æ–≥–æ –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤ —Å —Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≤ Supabase Storage.

### üìã –ó–∞–¥–∞—á–∏

#### 1.1. –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ –ø–æ–ª–µ–π

**–§–∞–π–ª:** `lib/universal-entity/types.ts`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**

```typescript
export type FieldType =
  | "select"
  | "text"
  | "textarea"
  | "number"
  | "date"
  | "boolean"
  | "radio"
  | "multipleSelect"
  | "array"
  | "dynamicValue"
  | "file" // ‚Üê –ù–û–í–û–ï: –æ–¥–∏–Ω —Ñ–∞–π–ª
  | "files"; // ‚Üê –ù–û–í–û–ï: –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ñ–∞–π–ª–æ–≤

export type DbType =
  | "varchar"
  | "float"
  | "boolean"
  | "timestamptz"
  | "manyToOne"
  | "oneToMany"
  | "manyToMany"
  | "oneToOne"
  | "file" // ‚Üê –ù–û–í–û–ï: –¥–ª—è –æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ (—Ö—Ä–∞–Ω–∏—Ç URL)
  | "files"; // ‚Üê –ù–û–í–û–ï: –¥–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤ (—Ö—Ä–∞–Ω–∏—Ç –º–∞—Å—Å–∏–≤ URL)
```

**–î–æ–±–∞–≤–∏—Ç—å –≤ `Field` –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å:**

```typescript
export interface Field {
  // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è

  // File upload configuration
  acceptFileTypes?: string | null; // "image/*", "application/pdf", etc.
  maxFileSize?: number | null; // –≤ –±–∞–π—Ç–∞—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, 5242880 = 5MB)
  maxFiles?: number | null; // –¥–ª—è —Ç–∏–ø–∞ "files" (–º–∞–∫—Å–∏–º—É–º —Ñ–∞–π–ª–æ–≤)
  storageBucket?: string | null; // –∏–º—è bucket –≤ Supabase Storage (default: "files")
}
```

**–û—Ü–µ–Ω–∫–∞:** 30 –º–∏–Ω—É—Ç

---

#### 1.2. SQL –º–∏–≥—Ä–∞—Ü–∏—è –¥–ª—è –ø–æ–ª–µ–π —Ñ–∞–π–ª–æ–≤

**–§–∞–π–ª:** `supabase/migrations/YYYYMMDD_add_file_fields.sql`

**–°–æ–¥–µ—Ä–∂–∏–º–æ–µ:**

```sql
-- –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–µ —Ç–∏–ø—ã –≤ CHECK constraint –¥–ª—è field.type
ALTER TABLE field
  DROP CONSTRAINT IF EXISTS field_type_check;

ALTER TABLE field
  ADD CONSTRAINT field_type_check
  CHECK (type IN (
    'select', 'text', 'textarea', 'number', 'date',
    'boolean', 'radio', 'multipleSelect', 'array',
    'dynamicValue', 'file', 'files'
  ));

-- –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–µ —Ç–∏–ø—ã –≤ CHECK constraint –¥–ª—è field.db_type
ALTER TABLE field
  DROP CONSTRAINT IF EXISTS field_db_type_check;

ALTER TABLE field
  ADD CONSTRAINT field_db_type_check
  CHECK (db_type IN (
    'varchar', 'float', 'boolean', 'timestamptz',
    'manyToOne', 'oneToMany', 'manyToMany', 'oneToOne',
    'file', 'files'
  ));

-- –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–ª—è –¥–ª—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Ñ–∞–π–ª–æ–≤
ALTER TABLE field
  ADD COLUMN IF NOT EXISTS accept_file_types TEXT,
  ADD COLUMN IF NOT EXISTS max_file_size BIGINT,
  ADD COLUMN IF NOT EXISTS max_files INTEGER,
  ADD COLUMN IF NOT EXISTS storage_bucket TEXT DEFAULT 'files';

-- –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
COMMENT ON COLUMN field.accept_file_types IS 'MIME types, –Ω–∞–ø—Ä–∏–º–µ—Ä: image/*, application/pdf';
COMMENT ON COLUMN field.max_file_size IS '–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –≤ –±–∞–π—Ç–∞—Ö';
COMMENT ON COLUMN field.max_files IS '–ú–∞–∫—Å–∏–º—É–º —Ñ–∞–π–ª–æ–≤ –¥–ª—è —Ç–∏–ø–∞ files';
COMMENT ON COLUMN field.storage_bucket IS '–ò–º—è bucket –≤ Supabase Storage';
```

**–û—Ü–µ–Ω–∫–∞:** 15 –º–∏–Ω—É—Ç

---

#### 1.3. –°–æ–∑–¥–∞–Ω–∏–µ Supabase Storage bucket

**–§–∞–π–ª:** `supabase/migrations/YYYYMMDD_create_storage_bucket.sql`

**–°–æ–¥–µ—Ä–∂–∏–º–æ–µ:**

```sql
-- –°–æ–∑–¥–∞–µ–º bucket –¥–ª—è —Ñ–∞–π–ª–æ–≤ (–µ—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
INSERT INTO storage.buckets (id, name, public)
VALUES ('files', 'files', true)
ON CONFLICT (id) DO NOTHING;

-- RLS –ø–æ–ª–∏—Ç–∏–∫–∏ –¥–ª—è bucket
CREATE POLICY "Public Access"
  ON storage.objects FOR SELECT
  USING (bucket_id = 'files');

CREATE POLICY "Authenticated users can upload"
  ON storage.objects FOR INSERT
  WITH CHECK (
    bucket_id = 'files'
    AND auth.role() = 'authenticated'
  );

CREATE POLICY "Users can update own files"
  ON storage.objects FOR UPDATE
  USING (
    bucket_id = 'files'
    AND auth.role() = 'authenticated'
  );

CREATE POLICY "Users can delete own files"
  ON storage.objects FOR DELETE
  USING (
    bucket_id = 'files'
    AND auth.role() = 'authenticated'
  );
```

**–û—Ü–µ–Ω–∫–∞:** 20 –º–∏–Ω—É—Ç

---

#### 1.4. –°–µ—Ä–≤–∏—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ñ–∞–π–ª–∞–º–∏

**–§–∞–π–ª:** `lib/storage/file-service.ts`

**–°–æ–¥–µ—Ä–∂–∏–º–æ–µ:**

```typescript
import { createClient } from "@/lib/supabase/server";
import { createBrowserClient } from "@supabase/ssr";

export interface FileUploadOptions {
  bucket?: string;
  folder?: string; // –ø–æ–¥–ø–∞–ø–∫–∞ –≤ bucket (–Ω–∞–ø—Ä–∏–º–µ—Ä, "avatars", "documents")
  maxSize?: number;
  acceptTypes?: string[];
}

export interface UploadedFile {
  url: string;
  path: string;
  name: string;
  size: number;
  type: string;
}

/**
 * –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (Server Action)
 */
export async function uploadFile(
  file: File,
  options: FileUploadOptions = {}
): Promise<UploadedFile> {
  const supabase = await createClient();
  const bucket = options.bucket || "files";
  const folder = options.folder || "";

  // –í–∞–ª–∏–¥–∞—Ü–∏—è —Ä–∞–∑–º–µ—Ä–∞
  if (options.maxSize && file.size > options.maxSize) {
    throw new Error(`File size exceeds ${options.maxSize} bytes`);
  }

  // –í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–∏–ø–∞
  if (
    options.acceptTypes &&
    !options.acceptTypes.some((type) => {
      if (type.endsWith("/*")) {
        return file.type.startsWith(type.slice(0, -1));
      }
      return file.type === type;
    })
  ) {
    throw new Error(`File type ${file.type} not allowed`);
  }

  // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —É–Ω–∏–∫–∞–ª—å–Ω–æ–µ –∏–º—è —Ñ–∞–π–ª–∞
  const timestamp = Date.now();
  const random = Math.random().toString(36).substring(2, 15);
  const extension = file.name.split(".").pop();
  const fileName = `${timestamp}-${random}.${extension}`;
  const filePath = folder ? `${folder}/${fileName}` : fileName;

  // –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º File –≤ ArrayBuffer
  const arrayBuffer = await file.arrayBuffer();
  const { data, error } = await supabase.storage
    .from(bucket)
    .upload(filePath, arrayBuffer, {
      contentType: file.type,
      upsert: false,
    });

  if (error) {
    throw new Error(`Failed to upload file: ${error.message}`);
  }

  // –ü–æ–ª—É—á–∞–µ–º –ø—É–±–ª–∏—á–Ω—ã–π URL
  const {
    data: { publicUrl },
  } = supabase.storage.from(bucket).getPublicUrl(filePath);

  return {
    url: publicUrl,
    path: filePath,
    name: file.name,
    size: file.size,
    type: file.type,
  };
}

/**
 * –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤
 */
export async function uploadFiles(
  files: File[],
  options: FileUploadOptions = {}
): Promise<UploadedFile[]> {
  return Promise.all(files.map((file) => uploadFile(file, options)));
}

/**
 * –£–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–∞
 */
export async function deleteFile(
  path: string,
  bucket: string = "files"
): Promise<void> {
  const supabase = await createClient();
  const { error } = await supabase.storage.from(bucket).remove([path]);

  if (error) {
    throw new Error(`Failed to delete file: ${error.message}`);
  }
}

/**
 * –£–¥–∞–ª–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤
 */
export async function deleteFiles(
  paths: string[],
  bucket: string = "files"
): Promise<void> {
  const supabase = await createClient();
  const { error } = await supabase.storage.from(bucket).remove(paths);

  if (error) {
    throw new Error(`Failed to delete files: ${error.message}`);
  }
}
```

**–û—Ü–µ–Ω–∫–∞:** 1-2 —á–∞—Å–∞

---

#### 1.5. API route –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤

**–§–∞–π–ª:** `app/api/storage/upload/route.ts`

**–°–æ–¥–µ—Ä–∂–∏–º–æ–µ:**

```typescript
import { NextRequest, NextResponse } from "next/server";
import { uploadFile, uploadFiles } from "@/lib/storage/file-service";

export async function POST(request: NextRequest) {
  try {
    const formData = await request.formData();
    const files = formData.getAll("files") as File[];
    const bucket = formData.get("bucket") as string | null;
    const folder = formData.get("folder") as string | null;
    const maxSize = formData.get("maxSize")
      ? parseInt(formData.get("maxSize") as string)
      : undefined;
    const acceptTypes = formData.get("acceptTypes")
      ? (formData.get("acceptTypes") as string).split(",")
      : undefined;

    if (files.length === 0) {
      return NextResponse.json({ error: "No files provided" }, { status: 400 });
    }

    const options = {
      bucket: bucket || undefined,
      folder: folder || undefined,
      maxSize,
      acceptTypes,
    };

    if (files.length === 1) {
      const result = await uploadFile(files[0], options);
      return NextResponse.json(result);
    } else {
      const results = await uploadFiles(files, options);
      return NextResponse.json(results);
    }
  } catch (error) {
    console.error("[Storage Upload] Error:", error);
    return NextResponse.json(
      { error: error instanceof Error ? error.message : "Upload failed" },
      { status: 500 }
    );
  }
}
```

**–û—Ü–µ–Ω–∫–∞:** 30 –º–∏–Ω—É—Ç

---

#### 1.6. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤

**–§–∞–π–ª:** `components/ui/file-upload.tsx`

**–°–æ–¥–µ—Ä–∂–∏–º–æ–µ:**

```typescript
"use client";

import { useState, useCallback } from "react";
import { Button } from "@/components/ui/button";
import { Upload, X, File } from "lucide-react";
import { cn } from "@/lib/utils";

export interface FileUploadProps {
  value?: string | string[]; // URL –∏–ª–∏ –º–∞—Å—Å–∏–≤ URL
  onChange: (value: string | string[]) => void;
  multiple?: boolean;
  accept?: string;
  maxSize?: number; // –≤ –±–∞–π—Ç–∞—Ö
  maxFiles?: number;
  bucket?: string;
  folder?: string;
  disabled?: boolean;
  className?: string;
}

export function FileUpload({
  value,
  onChange,
  multiple = false,
  accept,
  maxSize,
  maxFiles,
  bucket,
  folder,
  disabled,
  className,
}: FileUploadProps) {
  const [uploading, setUploading] = useState(false);
  const [error, setError] = useState<string | null>(null);

  const handleFileSelect = useCallback(
    async (e: React.ChangeEvent<HTMLInputElement>) => {
      const files = e.target.files;
      if (!files || files.length === 0) return;

      setError(null);
      setUploading(true);

      try {
        const formData = new FormData();
        Array.from(files).forEach((file) => {
          formData.append("files", file);
        });
        if (bucket) formData.append("bucket", bucket);
        if (folder) formData.append("folder", folder);
        if (maxSize) formData.append("maxSize", maxSize.toString());
        if (accept) formData.append("acceptTypes", accept);

        const response = await fetch("/api/storage/upload", {
          method: "POST",
          body: formData,
        });

        if (!response.ok) {
          const data = await response.json();
          throw new Error(data.error || "Upload failed");
        }

        const uploaded = await response.json();

        if (multiple) {
          const current = Array.isArray(value) ? value : [];
          const newUrls = Array.isArray(uploaded)
            ? uploaded.map((f: any) => f.url)
            : [uploaded.url];
          onChange([...current, ...newUrls]);
        } else {
          onChange(Array.isArray(uploaded) ? uploaded[0].url : uploaded.url);
        }
      } catch (err) {
        setError(err instanceof Error ? err.message : "Upload failed");
      } finally {
        setUploading(false);
      }
    },
    [value, onChange, multiple, accept, maxSize, bucket, folder]
  );

  const handleRemove = useCallback(
    (index?: number) => {
      if (multiple && Array.isArray(value) && index !== undefined) {
        const newValue = [...value];
        newValue.splice(index, 1);
        onChange(newValue);
      } else {
        onChange(multiple ? [] : "");
      }
    },
    [value, onChange, multiple]
  );

  const currentFiles = multiple
    ? Array.isArray(value)
      ? value
      : []
    : value
    ? [value]
    : [];

  return (
    <div className={cn("space-y-2", className)}>
      <div className="flex items-center gap-2">
        <Button
          type="button"
          variant="outline"
          onClick={() => document.getElementById("file-input")?.click()}
          disabled={disabled || uploading}
        >
          <Upload className="h-4 w-4 mr-2" />
          {uploading ? "Uploading..." : "Upload File"}
        </Button>
        <input
          id="file-input"
          type="file"
          className="hidden"
          multiple={multiple}
          accept={accept}
          onChange={handleFileSelect}
          disabled={disabled || uploading}
        />
      </div>

      {error && <p className="text-sm text-red-500">{error}</p>}

      {currentFiles.length > 0 && (
        <div className="space-y-1">
          {currentFiles.map((url, index) => (
            <div
              key={index}
              className="flex items-center justify-between p-2 border rounded"
            >
              <div className="flex items-center gap-2">
                <File className="h-4 w-4" />
                <a
                  href={url}
                  target="_blank"
                  rel="noopener noreferrer"
                  className="text-sm text-blue-600 hover:underline truncate"
                >
                  {url.split("/").pop()}
                </a>
              </div>
              {!disabled && (
                <Button
                  type="button"
                  variant="ghost"
                  size="sm"
                  onClick={() => handleRemove(index)}
                >
                  <X className="h-4 w-4" />
                </Button>
              )}
            </div>
          ))}
        </div>
      )}
    </div>
  );
}
```

**–û—Ü–µ–Ω–∫–∞:** 2-3 —á–∞—Å–∞

---

#### 1.7. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ —Ñ–æ—Ä–º—É –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä

**–§–∞–π–ª:** `lib/form-generation/components/FieldRenderer.tsx`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
–î–æ–±–∞–≤–∏—Ç—å case –¥–ª—è `file` –∏ `files`:

```typescript
case "file":
case "files":
  return (
    <FileUpload
      value={fieldValue}
      onChange={handleChange}
      multiple={field.type === "files"}
      accept={field.acceptFileTypes || undefined}
      maxSize={field.maxFileSize || undefined}
      maxFiles={field.maxFiles || undefined}
      bucket={field.storageBucket || undefined}
      folder={`${entityDefinitionId}/${field.name}`}
      disabled={disabled}
    />
  );
```

**–û—Ü–µ–Ω–∫–∞:** 30 –º–∏–Ω—É—Ç

---

#### 1.8. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ –≤ config-service

**–§–∞–π–ª:** `lib/universal-entity/config-service.ts`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
–í —Ñ—É–Ω–∫—Ü–∏–∏ `transformField` –¥–æ–±–∞–≤–∏—Ç—å:

```typescript
acceptFileTypes: row.accept_file_types,
maxFileSize: row.max_file_size,
maxFiles: row.max_files,
storageBucket: row.storage_bucket,
```

**–û—Ü–µ–Ω–∫–∞:** 10 –º–∏–Ω—É—Ç

---

### ‚úÖ –ö—Ä–∏—Ç–µ—Ä–∏–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏

- [ ] –¢–∏–ø—ã `file` –∏ `files` –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ `FieldType` –∏ `DbType`
- [ ] SQL –º–∏–≥—Ä–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∞
- [ ] Supabase Storage bucket —Å–æ–∑–¥–∞–Ω
- [ ] –°–µ—Ä–≤–∏—Å `file-service.ts` —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
- [ ] API route `/api/storage/upload` —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –ö–æ–º–ø–æ–Ω–µ–Ω—Ç `FileUpload` —Å–æ–∑–¥–∞–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ —Ñ–æ—Ä–º—É –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä
- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: –∑–∞–≥—Ä—É–∑–∫–∞ –æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: –∑–∞–≥—Ä—É–∑–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤
- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ä–∞–∑–º–µ—Ä–∞ –∏ —Ç–∏–ø–∞

---

## –§–∞–∑–∞ 2: Content Types Builder

### üéØ –¶–µ–ª—å

–°–æ–∑–¥–∞—Ç—å –≤–∏–∑—É–∞–ª—å–Ω—ã–π —Ä–µ–¥–∞–∫—Ç–æ—Ä –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è `entity_definition` –∏ `field` –≤ —Å—Ç–∏–ª–µ Strapi Content Types Builder.

### üìã –ó–∞–¥–∞—á–∏

#### 2.1. –°—Ç—Ä–∞–Ω–∏—Ü–∞ Content Types Builder

**–§–∞–π–ª:** `app/projects/[projectId]/entity-definitions/builder/page.tsx`

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**

- –õ–µ–≤–∞—è –ø–∞–Ω–µ–ª—å: —Å–ø–∏—Å–æ–∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö Entity Definitions
- –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è –ø–∞–Ω–µ–ª—å: —Ä–µ–¥–∞–∫—Ç–æ—Ä –≤—ã–±—Ä–∞–Ω–Ω–æ–π Entity Definition
- –ü—Ä–∞–≤–∞—è –ø–∞–Ω–µ–ª—å: —Å–ø–∏—Å–æ–∫ –ø–æ–ª–µ–π (fields) –≤—ã–±—Ä–∞–Ω–Ω–æ–π Entity Definition

**–û—Ü–µ–Ω–∫–∞:** 1 –¥–µ–Ω—å

---

#### 2.2. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç Entity Definition Editor

**–§–∞–π–ª:** `components/entity-definition-builder/EntityDefinitionEditor.tsx`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**

- –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∞–∑–æ–≤—ã—Ö —Å–≤–æ–π—Å—Ç–≤ (name, description, type)
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ (createPermission, readPermission, etc.)
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ UI –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (pageTitle, buttons, etc.)
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ –∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤

**–û—Ü–µ–Ω–∫–∞:** 1 –¥–µ–Ω—å

---

#### 2.3. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç Field Editor

**–§–∞–π–ª:** `components/entity-definition-builder/FieldEditor.tsx`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**

- Drag & drop –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ—Ä—è–¥–∫–∞ –ø–æ–ª–µ–π
- –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–≤–æ–π—Å—Ç–≤ –ø–æ–ª—è (name, type, label, etc.)
- –í–∏–∑—É–∞–ª—å–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Å–≤—è–∑–µ–π (manyToOne, manyToMany, etc.)
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ (required, maxLength, etc.)
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ñ–∞–π–ª–æ–≤—ã—Ö –ø–æ–ª–µ–π (acceptTypes, maxSize, etc.)

**–û—Ü–µ–Ω–∫–∞:** 2 –¥–Ω—è

---

#### 2.4. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç Field Type Selector

**–§–∞–π–ª:** `components/entity-definition-builder/FieldTypeSelector.tsx`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**

- –í–∏–∑—É–∞–ª—å–Ω—ã–π –≤—ã–±–æ—Ä —Ç–∏–ø–∞ –ø–æ–ª—è
- –ò–∫–æ–Ω–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞
- –û–ø–∏—Å–∞–Ω–∏–µ —Ç–∏–ø–æ–≤
- –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞

**–û—Ü–µ–Ω–∫–∞:** 4 —á–∞—Å–∞

---

#### 2.5. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç Relation Builder

**–§–∞–π–ª:** `components/entity-definition-builder/RelationBuilder.tsx`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**

- –í–∏–∑—É–∞–ª—å–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Å–≤—è–∑–µ–π –º–µ–∂–¥—É Entity Definitions
- –í—ã–±–æ—Ä —Ç–∏–ø–∞ —Å–≤—è–∑–∏ (manyToOne, oneToMany, manyToMany, oneToOne)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –æ–±—Ä–∞—Ç–Ω—ã—Ö –ø–æ–ª–µ–π
- –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å–≤—è–∑–µ–π (–≥—Ä–∞—Ñ)

**–û—Ü–µ–Ω–∫–∞:** 1 –¥–µ–Ω—å

---

#### 2.6. –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä —Ñ–æ—Ä–º—ã

**–§–∞–π–ª:** `components/entity-definition-builder/FormPreview.tsx`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**

- Live preview —Ñ–æ—Ä–º—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ–∫—É—â–µ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤—Å–µ—Ö –ø–æ–ª–µ–π —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

**–û—Ü–µ–Ω–∫–∞:** 4 —á–∞—Å–∞

---

#### 2.7. Server Actions –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è

**–§–∞–π–ª:** `app/projects/[projectId]/entity-definitions/builder/actions.ts`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**

- `saveEntityDefinitionAction`
- `saveFieldAction`
- `deleteFieldAction`
- `reorderFieldsAction`

**–û—Ü–µ–Ω–∫–∞:** 4 —á–∞—Å–∞

---

### ‚úÖ –ö—Ä–∏—Ç–µ—Ä–∏–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏

- [ ] –°—Ç—Ä–∞–Ω–∏—Ü–∞ Builder —Å–æ–∑–¥–∞–Ω–∞ –∏ –¥–æ—Å—Ç—É–ø–Ω–∞
- [ ] –ú–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é Entity Definition —á–µ—Ä–µ–∑ UI
- [ ] –ú–æ–∂–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é Entity Definition
- [ ] –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å –ø–æ–ª—è —á–µ—Ä–µ–∑ UI
- [ ] –ú–æ–∂–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—è —á–µ—Ä–µ–∑ UI
- [ ] –ú–æ–∂–Ω–æ —É–¥–∞–ª—è—Ç—å –ø–æ–ª—è
- [ ] –ú–æ–∂–Ω–æ –∏–∑–º–µ–Ω—è—Ç—å –ø–æ—Ä—è–¥–æ–∫ –ø–æ–ª–µ–π (drag & drop)
- [ ] –ú–æ–∂–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å–≤—è–∑–∏ –º–µ–∂–¥—É Entity Definitions
- [ ] –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä —Ñ–æ—Ä–º—ã —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ë–î

---

## –§–∞–∑–∞ 3: –ü—É–±–ª–∏—á–Ω—ã–π API

### üéØ –¶–µ–ª—å

–°–æ–∑–¥–∞—Ç—å –ø—É–±–ª–∏—á–Ω—ã–π REST API –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å `entityInstance` —á–µ—Ä–µ–∑ `entityDefinition`, —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —É—Å–ª–æ–≤–Ω–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –≤ `entity_definition`.

### üìã –ó–∞–¥–∞—á–∏

#### 3.1. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—É–±–ª–∏—á–Ω–æ–≥–æ API

**Endpoint pattern:**

```
GET    /api/public/[projectId]/[entityDefinitionId]           - —Å–ø–∏—Å–æ–∫ —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤
GET    /api/public/[projectId]/[entityDefinitionId]/[id]     - –æ–¥–∏–Ω —ç–∫–∑–µ–º–ø–ª—è—Ä
POST   /api/public/[projectId]/[entityDefinitionId]          - —Å–æ–∑–¥–∞—Ç—å (–µ—Å–ª–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–æ)
PUT    /api/public/[projectId]/[entityDefinitionId]/[id]     - –æ–±–Ω–æ–≤–∏—Ç—å (–µ—Å–ª–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–æ)
DELETE /api/public/[projectId]/[entityDefinitionId]/[id]    - —É–¥–∞–ª–∏—Ç—å (–µ—Å–ª–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–æ)
```

**–û—Ü–µ–Ω–∫–∞:** 30 –º–∏–Ω—É—Ç (–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ)

---

#### 3.2. API Route: GET —Å–ø–∏—Å–æ–∫ —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤

**–§–∞–π–ª:** `app/api/public/[projectId]/[entityDefinitionId]/route.ts`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**

- –ü—Ä–æ–≤–µ—Ä–∫–∞ `readPermission` –∏–∑ `entity_definition`
- –ï—Å–ª–∏ `readPermission = "ALL"` ‚Üí –¥–æ—Å—Ç—É–ø –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- –ï—Å–ª–∏ `readPermission = "User"` ‚Üí —Ç—Ä–µ–±—É–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- –ï—Å–ª–∏ `readPermission = "Admin"` ‚Üí —Ç—Ä–µ–±—É–µ—Ç—Å—è —Ä–æ–ª—å admin
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏, –ø–∞–≥–∏–Ω–∞—Ü–∏–∏, –ø–æ–∏—Å–∫–∞
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ `includeRelations` –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Å–≤—è–∑–µ–π

**–û—Ü–µ–Ω–∫–∞:** 1 –¥–µ–Ω—å

---

#### 3.3. API Route: GET –æ–¥–∏–Ω —ç–∫–∑–µ–º–ø–ª—è—Ä

**–§–∞–π–ª:** `app/api/public/[projectId]/[entityDefinitionId]/[id]/route.ts`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**

- –¢–µ –∂–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
- –í–æ–∑–≤—Ä–∞—Ç –æ–¥–Ω–æ–≥–æ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ —Å –ø–æ–ª—è–º–∏
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ `includeRelations`

**–û—Ü–µ–Ω–∫–∞:** 4 —á–∞—Å–∞

---

#### 3.4. API Route: POST —Å–æ–∑–¥–∞—Ç—å —ç–∫–∑–µ–º–ø–ª—è—Ä

**–§–∞–π–ª:** `app/api/public/[projectId]/[entityDefinitionId]/route.ts` (POST –º–µ—Ç–æ–¥)

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**

- –ü—Ä–æ–≤–µ—Ä–∫–∞ `createPermission`
- –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –æ—Å–Ω–æ–≤–µ `field` –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- –°–æ–∑–¥–∞–Ω–∏–µ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ —á–µ—Ä–µ–∑ `instance-service`
- –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–æ–≤ (–µ—Å–ª–∏ –µ—Å—Ç—å —Ñ–∞–π–ª–æ–≤—ã–µ –ø–æ–ª—è)
- –°–æ–∑–¥–∞–Ω–∏–µ —Å–≤—è–∑–µ–π (–µ—Å–ª–∏ –µ—Å—Ç—å relation –ø–æ–ª—è)

**–û—Ü–µ–Ω–∫–∞:** 1 –¥–µ–Ω—å

---

#### 3.5. API Route: PUT –æ–±–Ω–æ–≤–∏—Ç—å —ç–∫–∑–µ–º–ø–ª—è—Ä

**–§–∞–π–ª:** `app/api/public/[projectId]/[entityDefinitionId]/[id]/route.ts` (PUT –º–µ—Ç–æ–¥)

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**

- –ü—Ä–æ–≤–µ—Ä–∫–∞ `updatePermission`
- –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞
- –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–æ–≤ (—É–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö, –∑–∞–≥—Ä—É–∑–∫–∞ –Ω–æ–≤—ã—Ö)
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–≤—è–∑–µ–π

**–û—Ü–µ–Ω–∫–∞:** 1 –¥–µ–Ω—å

---

#### 3.6. API Route: DELETE —É–¥–∞–ª–∏—Ç—å —ç–∫–∑–µ–º–ø–ª—è—Ä

**–§–∞–π–ª:** `app/api/public/[projectId]/[entityDefinitionId]/[id]/route.ts` (DELETE –º–µ—Ç–æ–¥)

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**

- –ü—Ä–æ–≤–µ—Ä–∫–∞ `deletePermission`
- –£–¥–∞–ª–µ–Ω–∏–µ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞
- –£–¥–∞–ª–µ–Ω–∏–µ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –∏–∑ Storage
- –£–¥–∞–ª–µ–Ω–∏–µ —Å–≤—è–∑–µ–π

**–û—Ü–µ–Ω–∫–∞:** 4 —á–∞—Å–∞

---

#### 3.7. –£—Ç–∏–ª–∏—Ç–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞

**–§–∞–π–ª:** `lib/api/public/permission-checker.ts`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**

```typescript
export async function checkPermission(
  entityDefinitionId: string,
  permission: "create" | "read" | "update" | "delete",
  userId?: string,
  userRole?: "admin" | "user"
): Promise<boolean>;
```

**–û—Ü–µ–Ω–∫–∞:** 2 —á–∞—Å–∞

---

#### 3.8. –û–±—Ä–∞–±–æ—Ç–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤ –ø—É–±–ª–∏—á–Ω–æ–º API

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**

- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Bearer token (JWT –∏–∑ Supabase)
- –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (–µ—Å–ª–∏ `readPermission = "ALL"`)
- –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (–µ—Å–ª–∏ `readPermission = "User"` –∏–ª–∏ `"Admin"`)

**–û—Ü–µ–Ω–∫–∞:** 4 —á–∞—Å–∞

---

#### 3.9. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API endpoints

**–§–∞–π–ª:** `docs/api/PUBLIC_API.md`

**–°–æ–¥–µ—Ä–∂–∏–º–æ–µ:**

- –û–ø–∏—Å–∞–Ω–∏–µ –≤—Å–µ—Ö endpoints
- –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –æ—Ç–≤–µ—Ç–æ–≤
- –ö–æ–¥—ã –æ—à–∏–±–æ–∫
- –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

**–û—Ü–µ–Ω–∫–∞:** 2 —á–∞—Å–∞

---

### ‚úÖ –ö—Ä–∏—Ç–µ—Ä–∏–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏

- [ ] GET —Å–ø–∏—Å–æ–∫ —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] GET –æ–¥–∏–Ω —ç–∫–∑–µ–º–ø–ª—è—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] POST —Å–æ–∑–¥–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç (—Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –ø—Ä–∞–≤)
- [ ] PUT –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç (—Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –ø—Ä–∞–≤)
- [ ] DELETE —É–¥–∞–ª–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç (—Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –ø—Ä–∞–≤)
- [ ] –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏ –ø–∞–≥–∏–Ω–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞—é—Ç
- [ ] –ü–æ–∏—Å–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –ó–∞–≥—Ä—É–∑–∫–∞ —Å–≤—è–∑–µ–π (`includeRelations`) —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- [ ] –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞

---

## –§–∞–∑–∞ 4: API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### üéØ –¶–µ–ª—å

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è OpenAPI/Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ `entity_definition` –∏ `field` –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏.

### üìã –ó–∞–¥–∞—á–∏

#### 4.1. –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä OpenAPI —Å—Ö–µ–º—ã

**–§–∞–π–ª:** `lib/api-docs/openapi-generator.ts`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**

- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è OpenAPI 3.0 —Å—Ö–µ–º—ã
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ `field.dbType`
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è endpoints –¥–ª—è –∫–∞–∂–¥–æ–≥–æ `entity_definition`
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–∏–º–µ—Ä–æ–≤ –∑–∞–ø—Ä–æ—Å–æ–≤/–æ—Ç–≤–µ—Ç–æ–≤

**–û—Ü–µ–Ω–∫–∞:** 1 –¥–µ–Ω—å

---

#### 4.2. API Route –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è OpenAPI —Å—Ö–µ–º—ã

**–§–∞–π–ª:** `app/api/docs/openapi.json/route.ts`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**

- –í–æ–∑–≤—Ä–∞—Ç OpenAPI —Å—Ö–µ–º—ã –≤ JSON —Ñ–æ—Ä–º–∞—Ç–µ
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ 5 –º–∏–Ω—É—Ç
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ `projectId`

**–û—Ü–µ–Ω–∫–∞:** 2 —á–∞—Å–∞

---

#### 4.3. Swagger UI —Å—Ç—Ä–∞–Ω–∏—Ü–∞

**–§–∞–π–ª:** `app/api/docs/page.tsx`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**

- –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π Swagger UI
- –í—ã–±–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
- –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API

**–û—Ü–µ–Ω–∫–∞:** 4 —á–∞—Å–∞

---

#### 4.4. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å

**–§–∞–π–ª:** `app/projects/[projectId]/settings/api-docs/page.tsx`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**

- –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π API –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞
- –ö–Ω–æ–ø–∫–∞ "Export OpenAPI schema"
- –ö–Ω–æ–ø–∫–∞ "Copy API URL"

**–û—Ü–µ–Ω–∫–∞:** 2 —á–∞—Å–∞

---

### ‚úÖ –ö—Ä–∏—Ç–µ—Ä–∏–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏

- [ ] OpenAPI —Å—Ö–µ–º–∞ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- [ ] Endpoint `/api/docs/openapi.json` —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] Swagger UI —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –¥–æ—Å—Ç—É–ø–Ω–∞
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ `entity_definition`
- [ ] –ú–æ–∂–Ω–æ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—Ö–µ–º—É
- [ ] –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤/–æ—Ç–≤–µ—Ç–æ–≤ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã

---

## –§–∞–∑–∞ 5: Webhooks

### üéØ –¶–µ–ª—å

–°–∏—Å—Ç–µ–º–∞ webhooks –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤–Ω–µ—à–Ω–∏—Ö —Å–∏—Å—Ç–µ–º –æ —Å–æ–±—ã—Ç–∏—è—Ö (create, update, delete) –≤ `entity_instance`.

### üìã –ó–∞–¥–∞—á–∏

#### 5.1. SQL –º–∏–≥—Ä–∞—Ü–∏—è –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã webhooks

**–§–∞–π–ª:** `supabase/migrations/YYYYMMDD_create_webhooks.sql`

**–°–æ–¥–µ—Ä–∂–∏–º–æ–µ:**

```sql
CREATE TABLE webhooks (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  project_id UUID NOT NULL REFERENCES projects(id) ON DELETE CASCADE,
  entity_definition_id UUID REFERENCES entity_definition(id) ON DELETE CASCADE,
  url TEXT NOT NULL,
  events TEXT[] NOT NULL, -- ['create', 'update', 'delete']
  secret TEXT, -- –¥–ª—è –ø–æ–¥–ø–∏—Å–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
  enabled BOOLEAN DEFAULT true,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

CREATE INDEX idx_webhooks_project_id ON webhooks(project_id);
CREATE INDEX idx_webhooks_entity_definition_id ON webhooks(entity_definition_id);
```

**–û—Ü–µ–Ω–∫–∞:** 15 –º–∏–Ω—É—Ç

---

#### 5.2. –°–µ—Ä–≤–∏—Å –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ webhooks

**–§–∞–π–ª:** `lib/webhooks/webhook-service.ts`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**

- `sendWebhook(url, event, data, secret)` - –æ—Ç–ø—Ä–∞–≤–∫–∞ –æ–¥–Ω–æ–≥–æ webhook
- `triggerWebhooks(entityDefinitionId, event, data)` - –æ—Ç–ø—Ä–∞–≤–∫–∞ –≤—Å–µ—Ö webhooks –¥–ª—è —Å–æ–±—ã—Ç–∏—è
- –ü–æ–¥–ø–∏—Å—å –∑–∞–ø—Ä–æ—Å–æ–≤ —á–µ—Ä–µ–∑ HMAC SHA256
- Retry –ª–æ–≥–∏–∫–∞ (3 –ø–æ–ø—ã—Ç–∫–∏)
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫

**–û—Ü–µ–Ω–∫–∞:** 1 –¥–µ–Ω—å

---

#### 5.3. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ instance-service

**–§–∞–π–ª:** `lib/universal-entity/instance-service.ts`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**

- –í—ã–∑–æ–≤ `triggerWebhooks` –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ create/update/delete
- –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ (–Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –æ—Å–Ω–æ–≤–Ω–æ–π –ø–æ—Ç–æ–∫)

**–û—Ü–µ–Ω–∫–∞:** 2 —á–∞—Å–∞

---

#### 5.4. UI –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è webhooks

**–§–∞–π–ª:** `app/projects/[projectId]/settings/webhooks/page.tsx`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**

- –°–ø–∏—Å–æ–∫ webhooks –ø—Ä–æ–µ–∫—Ç–∞
- –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ webhook
- –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ webhook
- –£–¥–∞–ª–µ–Ω–∏–µ webhook
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ webhook (–æ—Ç–ø—Ä–∞–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞)

**–û—Ü–µ–Ω–∫–∞:** 1 –¥–µ–Ω—å

---

#### 5.5. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ webhooks

**–§–∞–π–ª:** `supabase/migrations/YYYYMMDD_create_webhook_logs.sql`

**–°–æ–¥–µ—Ä–∂–∏–º–æ–µ:**

```sql
CREATE TABLE webhook_logs (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  webhook_id UUID NOT NULL REFERENCES webhooks(id) ON DELETE CASCADE,
  event TEXT NOT NULL,
  status_code INTEGER,
  response_body TEXT,
  error_message TEXT,
  created_at TIMESTAMPTZ DEFAULT NOW()
);

CREATE INDEX idx_webhook_logs_webhook_id ON webhook_logs(webhook_id);
CREATE INDEX idx_webhook_logs_created_at ON webhook_logs(created_at);
```

**–û—Ü–µ–Ω–∫–∞:** 30 –º–∏–Ω—É—Ç

---

### ‚úÖ –ö—Ä–∏—Ç–µ—Ä–∏–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏

- [ ] –¢–∞–±–ª–∏—Ü–∞ webhooks —Å–æ–∑–¥–∞–Ω–∞
- [ ] –°–µ—Ä–≤–∏—Å –æ—Ç–ø—Ä–∞–≤–∫–∏ webhooks —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] Webhooks –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –ø—Ä–∏ create/update/delete
- [ ] UI –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è webhooks —Å–æ–∑–¥–∞–Ω
- [ ] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ webhooks —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –ü–æ–¥–ø–∏—Å—å –∑–∞–ø—Ä–æ—Å–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] Retry –ª–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç

---

## –§–∞–∑–∞ 6: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–≥–æ –∫–æ–¥–∞

### üéØ –¶–µ–ª—å

–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≥–æ—Ç–æ–≤–æ–≥–æ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (Next.js/React) —Å –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º–∏ —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º–∏ –¥–ª—è –≤—Å–µ—Ö `entity_definition` –ø—Ä–æ–µ–∫—Ç–∞, —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ API –∫–ª–∏–µ–Ω—Ç–∞–º–∏ –∏ –≥–æ—Ç–æ–≤—ã–º–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏.

### üìã –ó–∞–¥–∞—á–∏

#### 6.1. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**

```
generated-client/
‚îú‚îÄ‚îÄ .env.example
‚îú‚îÄ‚îÄ package.json
‚îú‚îÄ‚îÄ next.config.js
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ layout.tsx
‚îÇ   ‚îú‚îÄ‚îÄ page.tsx
‚îÇ   ‚îî‚îÄ‚îÄ [entityDefinitionId]/
‚îÇ       ‚îú‚îÄ‚îÄ page.tsx (—Å–ø–∏—Å–æ–∫)
‚îÇ       ‚îú‚îÄ‚îÄ new/page.tsx (—Å–æ–∑–¥–∞–Ω–∏–µ)
‚îÇ       ‚îî‚îÄ‚îÄ [id]/
‚îÇ           ‚îú‚îÄ‚îÄ page.tsx (–¥–µ—Ç–∞–ª–∏)
‚îÇ           ‚îî‚îÄ‚îÄ edit/page.tsx (—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)
‚îú‚îÄ‚îÄ lib/
‚îÇ   ‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ client.ts (—Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π API –∫–ª–∏–µ–Ω—Ç)
‚îÇ   ‚îî‚îÄ‚îÄ types/
‚îÇ       ‚îî‚îÄ‚îÄ entities.ts (TypeScript —Ç–∏–ø—ã)
‚îî‚îÄ‚îÄ components/
    ‚îî‚îÄ‚îÄ entities/
        ‚îî‚îÄ‚îÄ [EntityName]Form.tsx
```

**–û—Ü–µ–Ω–∫–∞:** 30 –º–∏–Ω—É—Ç (–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ)

---

#### 6.2. –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä TypeScript —Ç–∏–ø–æ–≤

**–§–∞–π–ª:** `lib/client-code-generator/types-generator.ts`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**

- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è TypeScript –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ `entity_definition` –∏ `field`
- –¢–∏–ø–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö –ø–æ–ª–µ–π
- –¢–∏–ø–∏–∑–∞—Ü–∏—è —Å–≤—è–∑–µ–π
- –≠–∫—Å–ø–æ—Ä—Ç –≤ —Ñ–∞–π–ª `lib/types/entities.ts`

**–û—Ü–µ–Ω–∫–∞:** 1 –¥–µ–Ω—å

---

#### 6.3. –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä API –∫–ª–∏–µ–Ω—Ç–∞

**–§–∞–π–ª:** `lib/client-code-generator/api-client-generator.ts`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**

- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ `entity_definition`
- –ú–µ—Ç–æ–¥—ã: `getAll`, `getById`, `create`, `update`, `delete`
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏, –ø–∞–≥–∏–Ω–∞—Ü–∏–∏, –ø–æ–∏—Å–∫–∞
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

**–û—Ü–µ–Ω–∫–∞:** 1 –¥–µ–Ω—å

---

#### 6.4. –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü

**–§–∞–π–ª:** `lib/client-code-generator/pages-generator.ts`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**

- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü —Å–ø–∏—Å–∫–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ `entity_definition`
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü —Å–æ–∑–¥–∞–Ω–∏—è
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü –¥–µ—Ç–∞–ª–µ–π
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

**–û—Ü–µ–Ω–∫–∞:** 2 –¥–Ω—è

---

#### 6.5. –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Ñ–æ—Ä–º

**–§–∞–π–ª:** `lib/client-code-generator/forms-generator.ts`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**

- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ñ–æ—Ä–º –Ω–∞ –æ—Å–Ω–æ–≤–µ `field` –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –ø–æ–ª–µ–π
- –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–∞–≤–∏–ª –∏–∑ `field`
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å react-hook-form

**–û—Ü–µ–Ω–∫–∞:** 1 –¥–µ–Ω—å

---

#### 6.6. –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä package.json –∏ –∫–æ–Ω—Ñ–∏–≥–æ–≤

**–§–∞–π–ª:** `lib/client-code-generator/config-generator.ts`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**

- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è `package.json` —Å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è `.env.example` —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è `next.config.js`
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è `tsconfig.json`

**–û—Ü–µ–Ω–∫–∞:** 4 —á–∞—Å–∞

---

#### 6.7. API Route –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è

**–§–∞–π–ª:** `app/api/projects/[projectId]/generate-client/route.ts`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**

- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≤—Å–µ–≥–æ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–≥–æ –∫–æ–¥–∞
- –£–ø–∞–∫–æ–≤–∫–∞ –≤ ZIP –∞—Ä—Ö–∏–≤
- –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –∞—Ä—Ö–∏–≤–∞

**–û—Ü–µ–Ω–∫–∞:** 1 –¥–µ–Ω—å

---

#### 6.8. UI –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞

**–§–∞–π–ª:** `app/projects/[projectId]/settings/generate-client/page.tsx`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**

- –ö–Ω–æ–ø–∫–∞ "Generate Client Application"
- –í—ã–±–æ—Ä –æ–ø—Ü–∏–π (TypeScript, React, Next.js –≤–µ—Ä—Å–∏—è)
- –ü—Ä–æ–≥—Ä–µ—Å—Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
- –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –≥–æ—Ç–æ–≤–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞

**–û—Ü–µ–Ω–∫–∞:** 4 —á–∞—Å–∞

---

### ‚úÖ –ö—Ä–∏—Ç–µ—Ä–∏–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏

- [ ] TypeScript —Ç–∏–ø—ã –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- [ ] API –∫–ª–∏–µ–Ω—Ç –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ç–∏–ø–∏–∑–∞—Ü–∏–µ–π
- [ ] –°—Ç—Ä–∞–Ω–∏—Ü—ã –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –¥–ª—è –≤—Å–µ—Ö `entity_definition`
- [ ] –§–æ—Ä–º—ã –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
- [ ] package.json –∏ –∫–æ–Ω—Ñ–∏–≥–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è
- [ ] ZIP –∞—Ä—Ö–∏–≤ —Å–æ–∑–¥–∞–µ—Ç—Å—è –∏ —Å–∫–∞—á–∏–≤–∞–µ—Ç—Å—è
- [ ] –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- [ ] –í—Å–µ CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –≤ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –ø—Ä–æ–µ–∫—Ç–µ

---

## üìä –ò—Ç–æ–≥–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏

| –§–∞–∑–∞                               | –í—Ä–µ–º—è          | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç  |
| ---------------------------------- | -------------- | ---------- |
| –§–∞–∑–∞ 1: –§–∞–π–ª—ã –∏ Storage            | 3-4 –¥–Ω—è        | üî¥ –í—ã—Å–æ–∫–∏–π |
| –§–∞–∑–∞ 2: Content Types Builder      | 5-7 –¥–Ω–µ–π       | üî¥ –í—ã—Å–æ–∫–∏–π |
| –§–∞–∑–∞ 3: –ü—É–±–ª–∏—á–Ω—ã–π API              | 4-5 –¥–Ω–µ–π       | üî¥ –í—ã—Å–æ–∫–∏–π |
| –§–∞–∑–∞ 4: API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è           | 2-3 –¥–Ω—è        | üü° –°—Ä–µ–¥–Ω–∏–π |
| –§–∞–∑–∞ 5: Webhooks                   | 2-3 –¥–Ω—è        | üü¢ –ù–∏–∑–∫–∏–π  |
| –§–∞–∑–∞ 6: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–≥–æ –∫–æ–¥–∞ | 5-7 –¥–Ω–µ–π       | üü° –°—Ä–µ–¥–Ω–∏–π |
| **–ò–¢–û–ì–û**                          | **21-29 –¥–Ω–µ–π** |            |

---

## üöÄ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç—É –¥–æ—Ä–æ–∂–Ω—É—é –∫–∞—Ä—Ç—É

1. **–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–∑—É** –∏–∑ —Å–ø–∏—Å–∫–∞ –≤—ã—à–µ
2. **–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤–µ—Å—å —Ä–∞–∑–¥–µ–ª —Ñ–∞–∑—ã** (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–§–∞–∑–∞ 1: –§–∞–π–ª—ã –∏ Storage")
3. **–í—Å—Ç–∞–≤—å—Ç–µ –≤ —á–∞—Ç** –∏ –Ω–∞—á–Ω–∏—Ç–µ —Ä–∞–±–æ—Ç—É
4. **–°–ª–µ–¥—É–π—Ç–µ –∑–∞–¥–∞—á–∞–º –ø–æ –ø–æ—Ä—è–¥–∫—É**
5. **–û—Ç–º–µ—á–∞–π—Ç–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏** –≤ –∫—Ä–∏—Ç–µ—Ä–∏—è—Ö –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏

---

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –í—Å–µ –æ—Ü–µ–Ω–∫–∏ –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω—ã–µ –∏ –º–æ–≥—É—Ç –≤–∞—Ä—å–∏—Ä–æ–≤–∞—Ç—å—Å—è
- –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –∑–∞–¥–∞—á–∏ –º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
- –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–µ–ª–∞—Ç—å –∫–æ–º–º–∏—Ç—ã –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–π –∑–∞–≤–µ—Ä—à–µ–Ω–Ω–æ–π –∑–∞–¥–∞—á–∏
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —á–∞—Å—Ç—å—é –∫–∞–∂–¥–æ–π —Ñ–∞–∑—ã

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2025-01-XX  
**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞:** 1.0
